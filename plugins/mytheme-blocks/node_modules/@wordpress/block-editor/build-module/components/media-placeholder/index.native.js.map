{"version":3,"sources":["@wordpress/block-editor/src/components/media-placeholder/index.native.js"],"names":["View","Text","TouchableWithoutFeedback","uniqWith","__","sprintf","MediaUpload","MEDIA_TYPE_IMAGE","MEDIA_TYPE_VIDEO","Dashicon","withPreferredColorScheme","useRef","styles","dedupMedia","media","media1","media2","id","url","MediaPlaceholder","props","addToGallery","allowedTypes","labels","icon","onSelect","isAppender","disableMediaButtons","getStylesFromColorScheme","multiple","value","mediaRef","current","setMedia","selected","isOneType","length","isImage","includes","isVideo","placeholderTitle","title","undefined","instructions","accessibilityHint","emptyStateTitleStyle","emptyStateTitle","emptyStateTitleDark","addMediaButtonStyle","addMediaButton","addMediaButtonDark","renderContent","modalIcon","emptyStateDescription","color","size","appenderStyle","appender","appenderDark","emptyStateContainerStyle","emptyStateContainer","emptyStateContainerDark","flex","open","getMediaOptions","event","onFocus"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { View, Text, TouchableWithoutFeedback } from 'react-native';\nimport { uniqWith } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport {\n\tMediaUpload,\n\tMEDIA_TYPE_IMAGE,\n\tMEDIA_TYPE_VIDEO,\n} from '@wordpress/block-editor';\nimport { Dashicon } from '@wordpress/components';\nimport { withPreferredColorScheme } from '@wordpress/compose';\nimport { useRef } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\n\n// remove duplicates after gallery append\nconst dedupMedia = ( media ) =>\n\tuniqWith(\n\t\tmedia,\n\t\t( media1, media2 ) =>\n\t\t\tmedia1.id === media2.id || media1.url === media2.url\n\t);\n\nfunction MediaPlaceholder( props ) {\n\tconst {\n\t\taddToGallery,\n\t\tallowedTypes = [],\n\t\tlabels = {},\n\t\ticon,\n\t\tonSelect,\n\t\tisAppender,\n\t\tdisableMediaButtons,\n\t\tgetStylesFromColorScheme,\n\t\tmultiple,\n\t\tvalue = [],\n\t} = props;\n\n\t// use ref to keep media array current for callbacks during rerenders\n\tconst mediaRef = useRef( value );\n\tmediaRef.current = value;\n\n\t// append and deduplicate media array for gallery use case\n\tconst setMedia =\n\t\tmultiple && addToGallery\n\t\t\t? ( selected ) =>\n\t\t\t\t\tonSelect(\n\t\t\t\t\t\tdedupMedia( [ ...mediaRef.current, ...selected ] )\n\t\t\t\t\t)\n\t\t\t: onSelect;\n\n\tconst isOneType = allowedTypes.length === 1;\n\tconst isImage = isOneType && allowedTypes.includes( MEDIA_TYPE_IMAGE );\n\tconst isVideo = isOneType && allowedTypes.includes( MEDIA_TYPE_VIDEO );\n\n\tlet placeholderTitle = labels.title;\n\tif ( placeholderTitle === undefined ) {\n\t\tplaceholderTitle = __( 'Media' );\n\t\tif ( isImage ) {\n\t\t\tplaceholderTitle = __( 'Image' );\n\t\t} else if ( isVideo ) {\n\t\t\tplaceholderTitle = __( 'Video' );\n\t\t}\n\t}\n\n\tlet instructions = labels.instructions;\n\tif ( instructions === undefined ) {\n\t\tif ( isImage ) {\n\t\t\tinstructions = __( 'ADD IMAGE' );\n\t\t} else if ( isVideo ) {\n\t\t\tinstructions = __( 'ADD VIDEO' );\n\t\t} else {\n\t\t\tinstructions = __( 'ADD IMAGE OR VIDEO' );\n\t\t}\n\t}\n\n\tlet accessibilityHint = __( 'Double tap to select' );\n\tif ( isImage ) {\n\t\taccessibilityHint = __( 'Double tap to select an image' );\n\t} else if ( isVideo ) {\n\t\taccessibilityHint = __( 'Double tap to select a video' );\n\t}\n\n\tconst emptyStateTitleStyle = getStylesFromColorScheme(\n\t\tstyles.emptyStateTitle,\n\t\tstyles.emptyStateTitleDark\n\t);\n\tconst addMediaButtonStyle = getStylesFromColorScheme(\n\t\tstyles.addMediaButton,\n\t\tstyles.addMediaButtonDark\n\t);\n\n\tconst renderContent = () => {\n\t\tif ( isAppender === undefined || ! isAppender ) {\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t<View style={ styles.modalIcon }>{ icon }</View>\n\t\t\t\t\t<Text style={ emptyStateTitleStyle }>\n\t\t\t\t\t\t{ placeholderTitle }\n\t\t\t\t\t</Text>\n\t\t\t\t\t<Text style={ styles.emptyStateDescription }>\n\t\t\t\t\t\t{ instructions }\n\t\t\t\t\t</Text>\n\t\t\t\t</>\n\t\t\t);\n\t\t} else if ( isAppender && ! disableMediaButtons ) {\n\t\t\treturn (\n\t\t\t\t<Dashicon\n\t\t\t\t\ticon=\"plus-alt\"\n\t\t\t\t\tstyle={ addMediaButtonStyle }\n\t\t\t\t\tcolor={ addMediaButtonStyle.color }\n\t\t\t\t\tsize={ addMediaButtonStyle.size }\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\t};\n\n\tif ( isAppender && disableMediaButtons ) {\n\t\treturn null;\n\t}\n\n\tconst appenderStyle = getStylesFromColorScheme(\n\t\tstyles.appender,\n\t\tstyles.appenderDark\n\t);\n\tconst emptyStateContainerStyle = getStylesFromColorScheme(\n\t\tstyles.emptyStateContainer,\n\t\tstyles.emptyStateContainerDark\n\t);\n\n\treturn (\n\t\t<View style={ { flex: 1 } }>\n\t\t\t<MediaUpload\n\t\t\t\tallowedTypes={ allowedTypes }\n\t\t\t\tonSelect={ setMedia }\n\t\t\t\tmultiple={ multiple }\n\t\t\t\trender={ ( { open, getMediaOptions } ) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<TouchableWithoutFeedback\n\t\t\t\t\t\t\taccessibilityLabel={ sprintf(\n\t\t\t\t\t\t\t\t/* translators: accessibility text for the media block empty state. %s: media type */\n\t\t\t\t\t\t\t\t__( '%s block. Empty' ),\n\t\t\t\t\t\t\t\tplaceholderTitle\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\taccessibilityRole={ 'button' }\n\t\t\t\t\t\t\taccessibilityHint={ accessibilityHint }\n\t\t\t\t\t\t\tonPress={ ( event ) => {\n\t\t\t\t\t\t\t\tprops.onFocus( event );\n\t\t\t\t\t\t\t\topen();\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<View\n\t\t\t\t\t\t\t\tstyle={ [\n\t\t\t\t\t\t\t\t\temptyStateContainerStyle,\n\t\t\t\t\t\t\t\t\tisAppender && appenderStyle,\n\t\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ getMediaOptions() }\n\t\t\t\t\t\t\t\t{ renderContent() }\n\t\t\t\t\t\t\t</View>\n\t\t\t\t\t\t</TouchableWithoutFeedback>\n\t\t\t\t\t);\n\t\t\t\t} }\n\t\t\t/>\n\t\t</View>\n\t);\n}\n\nexport default withPreferredColorScheme( MediaPlaceholder );\n"]}