{"version":3,"sources":["@wordpress/block-editor/src/components/block-styles/index.js"],"names":["find","noop","classnames","compose","withSelect","withDispatch","TokenList","ENTER","SPACE","_x","getBlockType","cloneBlock","getBlockFromExample","BlockPreview","getActiveStyle","styles","className","values","style","indexOf","potentialStyleName","substring","activeStyle","name","replaceActiveStyle","newStyle","list","remove","add","value","BlockStyles","onChangeClassName","type","block","onSwitch","onHoverClassName","length","label","isDefault","updateClassName","updatedClassName","map","styleClassName","event","keyCode","preventDefault","example","attributes","innerBlocks","select","clientId","getBlock","getBlockStyles","blockType","dispatch","newClassName","updateBlockAttributes"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { find, noop } from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { compose } from '@wordpress/compose';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport TokenList from '@wordpress/token-list';\nimport { ENTER, SPACE } from '@wordpress/keycodes';\nimport { _x } from '@wordpress/i18n';\nimport {\n\tgetBlockType,\n\tcloneBlock,\n\tgetBlockFromExample,\n} from '@wordpress/blocks';\n\n/**\n * Internal dependencies\n */\nimport BlockPreview from '../block-preview';\n\n/**\n * Returns the active style from the given className.\n *\n * @param {Array} styles Block style variations.\n * @param {string} className  Class name\n *\n * @return {Object?} The active style.\n */\nexport function getActiveStyle( styles, className ) {\n\tfor ( const style of new TokenList( className ).values() ) {\n\t\tif ( style.indexOf( 'is-style-' ) === -1 ) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tconst potentialStyleName = style.substring( 9 );\n\t\tconst activeStyle = find( styles, { name: potentialStyleName } );\n\t\tif ( activeStyle ) {\n\t\t\treturn activeStyle;\n\t\t}\n\t}\n\n\treturn find( styles, 'isDefault' );\n}\n\n/**\n * Replaces the active style in the block's className.\n *\n * @param {string}  className   Class name.\n * @param {Object?} activeStyle The replaced style.\n * @param {Object}  newStyle    The replacing style.\n *\n * @return {string} The updated className.\n */\nexport function replaceActiveStyle( className, activeStyle, newStyle ) {\n\tconst list = new TokenList( className );\n\n\tif ( activeStyle ) {\n\t\tlist.remove( 'is-style-' + activeStyle.name );\n\t}\n\n\tlist.add( 'is-style-' + newStyle.name );\n\n\treturn list.value;\n}\n\nfunction BlockStyles( {\n\tstyles,\n\tclassName,\n\tonChangeClassName,\n\ttype,\n\tblock,\n\tonSwitch = noop,\n\tonHoverClassName = noop,\n} ) {\n\tif ( ! styles || styles.length === 0 ) {\n\t\treturn null;\n\t}\n\n\tif ( ! type.styles && ! find( styles, 'isDefault' ) ) {\n\t\tstyles = [\n\t\t\t{\n\t\t\t\tname: 'default',\n\t\t\t\tlabel: _x( 'Default', 'block style' ),\n\t\t\t\tisDefault: true,\n\t\t\t},\n\t\t\t...styles,\n\t\t];\n\t}\n\n\tconst activeStyle = getActiveStyle( styles, className );\n\tfunction updateClassName( style ) {\n\t\tconst updatedClassName = replaceActiveStyle(\n\t\t\tclassName,\n\t\t\tactiveStyle,\n\t\t\tstyle\n\t\t);\n\t\tonChangeClassName( updatedClassName );\n\t\tonHoverClassName( null );\n\t\tonSwitch();\n\t}\n\n\treturn (\n\t\t<div className=\"block-editor-block-styles\">\n\t\t\t{ styles.map( ( style ) => {\n\t\t\t\tconst styleClassName = replaceActiveStyle(\n\t\t\t\t\tclassName,\n\t\t\t\t\tactiveStyle,\n\t\t\t\t\tstyle\n\t\t\t\t);\n\t\t\t\treturn (\n\t\t\t\t\t<div\n\t\t\t\t\t\tkey={ style.name }\n\t\t\t\t\t\tclassName={ classnames(\n\t\t\t\t\t\t\t'block-editor-block-styles__item',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'is-active': activeStyle === style,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t) }\n\t\t\t\t\t\tonClick={ () => updateClassName( style ) }\n\t\t\t\t\t\tonKeyDown={ ( event ) => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tENTER === event.keyCode ||\n\t\t\t\t\t\t\t\tSPACE === event.keyCode\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t\tupdateClassName( style );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonMouseEnter={ () =>\n\t\t\t\t\t\t\tonHoverClassName( styleClassName )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonMouseLeave={ () => onHoverClassName( null ) }\n\t\t\t\t\t\trole=\"button\"\n\t\t\t\t\t\ttabIndex=\"0\"\n\t\t\t\t\t\taria-label={ style.label || style.name }\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"block-editor-block-styles__item-preview\">\n\t\t\t\t\t\t\t<BlockPreview\n\t\t\t\t\t\t\t\tviewportWidth={ 500 }\n\t\t\t\t\t\t\t\tblocks={\n\t\t\t\t\t\t\t\t\ttype.example\n\t\t\t\t\t\t\t\t\t\t? getBlockFromExample( block.name, {\n\t\t\t\t\t\t\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t...type.example.attributes,\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName: styleClassName,\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\tinnerBlocks:\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype.example.innerBlocks,\n\t\t\t\t\t\t\t\t\t\t  } )\n\t\t\t\t\t\t\t\t\t\t: cloneBlock( block, {\n\t\t\t\t\t\t\t\t\t\t\t\tclassName: styleClassName,\n\t\t\t\t\t\t\t\t\t\t  } )\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"block-editor-block-styles__item-label\">\n\t\t\t\t\t\t\t{ style.label || style.name }\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t);\n\t\t\t} ) }\n\t\t</div>\n\t);\n}\n\nexport default compose( [\n\twithSelect( ( select, { clientId } ) => {\n\t\tconst { getBlock } = select( 'core/block-editor' );\n\t\tconst { getBlockStyles } = select( 'core/blocks' );\n\t\tconst block = getBlock( clientId );\n\t\tconst blockType = getBlockType( block.name );\n\n\t\treturn {\n\t\t\tblock,\n\t\t\tclassName: block.attributes.className || '',\n\t\t\tstyles: getBlockStyles( block.name ),\n\t\t\ttype: blockType,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { clientId } ) => {\n\t\treturn {\n\t\t\tonChangeClassName( newClassName ) {\n\t\t\t\tdispatch( 'core/block-editor' ).updateBlockAttributes(\n\t\t\t\t\tclientId,\n\t\t\t\t\t{\n\t\t\t\t\t\tclassName: newClassName,\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t},\n\t\t};\n\t} ),\n] )( BlockStyles );\n"]}