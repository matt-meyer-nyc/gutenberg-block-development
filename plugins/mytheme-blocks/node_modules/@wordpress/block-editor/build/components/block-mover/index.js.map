{"version":3,"sources":["@wordpress/block-editor/src/components/block-mover/index.js"],"names":["BlockMover","arguments","state","isFocused","onFocus","bind","onBlur","setState","props","onMoveUp","onMoveDown","orientation","__experimentalOrientation","isRTL","isFirst","isLast","clientIds","blockType","firstIndex","isLocked","instanceId","isHidden","rootClientId","hideDragHandle","blocksCount","length","getArrowIcon","moveDirection","rightArrow","leftArrow","chevronUp","chevronDown","getMovementDirectionLabel","onDraggableStart","onDraggableEnd","dragHandle","title","Component","select","getBlock","getBlockIndex","getTemplateLock","getBlockRootClientId","getBlockOrder","normalizedClientIds","firstClientId","block","blockOrder","lastIndex","getSettings","name","dispatch","moveBlocksDown","moveBlocksUp","withInstanceId"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { first, last, partial, castArray } from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Button, ToolbarGroup } from '@wordpress/components';\nimport { getBlockType } from '@wordpress/blocks';\nimport { Component } from '@wordpress/element';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { withInstanceId, compose } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { getBlockMoverDescription } from './mover-description';\nimport { leftArrow, rightArrow, dragHandle } from './icons';\nimport { chevronUp, chevronDown } from '@wordpress/icons';\nimport BlockDraggable from '../block-draggable';\n\nexport class BlockMover extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.state = {\n\t\t\tisFocused: false,\n\t\t};\n\t\tthis.onFocus = this.onFocus.bind( this );\n\t\tthis.onBlur = this.onBlur.bind( this );\n\t}\n\n\tonFocus() {\n\t\tthis.setState( {\n\t\t\tisFocused: true,\n\t\t} );\n\t}\n\n\tonBlur() {\n\t\tthis.setState( {\n\t\t\tisFocused: false,\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tonMoveUp,\n\t\t\tonMoveDown,\n\t\t\t__experimentalOrientation: orientation,\n\t\t\tisRTL,\n\t\t\tisFirst,\n\t\t\tisLast,\n\t\t\tclientIds,\n\t\t\tblockType,\n\t\t\tfirstIndex,\n\t\t\tisLocked,\n\t\t\tinstanceId,\n\t\t\tisHidden,\n\t\t\trootClientId,\n\t\t\thideDragHandle,\n\t\t} = this.props;\n\t\tconst { isFocused } = this.state;\n\t\tconst blocksCount = castArray( clientIds ).length;\n\t\tif ( isLocked || ( isFirst && isLast && ! rootClientId ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst getArrowIcon = ( moveDirection ) => {\n\t\t\tif ( moveDirection === 'up' ) {\n\t\t\t\tif ( orientation === 'horizontal' ) {\n\t\t\t\t\treturn isRTL ? rightArrow : leftArrow;\n\t\t\t\t}\n\t\t\t\treturn chevronUp;\n\t\t\t} else if ( moveDirection === 'down' ) {\n\t\t\t\tif ( orientation === 'horizontal' ) {\n\t\t\t\t\treturn isRTL ? leftArrow : rightArrow;\n\t\t\t\t}\n\t\t\t\treturn chevronDown;\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\n\t\tconst getMovementDirectionLabel = ( moveDirection ) => {\n\t\t\tif ( moveDirection === 'up' ) {\n\t\t\t\tif ( orientation === 'horizontal' ) {\n\t\t\t\t\treturn isRTL ? __( 'Move right' ) : __( 'Move left' );\n\t\t\t\t}\n\t\t\t\treturn __( 'Move up' );\n\t\t\t} else if ( moveDirection === 'down' ) {\n\t\t\t\tif ( orientation === 'horizontal' ) {\n\t\t\t\t\treturn isRTL ? __( 'Move left' ) : __( 'Move right' );\n\t\t\t\t}\n\t\t\t\treturn __( 'Move down' );\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\n\t\t// We emulate a disabled state because forcefully applying the `disabled`\n\t\t// attribute on the button while it has focus causes the screen to change\n\t\t// to an unfocused state (body as active element) without firing blur on,\n\t\t// the rendering parent, leaving it unable to react to focus out.\n\t\treturn (\n\t\t\t<ToolbarGroup\n\t\t\t\tclassName={ classnames( 'block-editor-block-mover', {\n\t\t\t\t\t'is-visible': isFocused || ! isHidden,\n\t\t\t\t\t'is-horizontal': orientation === 'horizontal',\n\t\t\t\t} ) }\n\t\t\t>\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"block-editor-block-mover__control\"\n\t\t\t\t\tonClick={ isFirst ? null : onMoveUp }\n\t\t\t\t\ticon={ getArrowIcon( 'up' ) }\n\t\t\t\t\tlabel={ getMovementDirectionLabel( 'up' ) }\n\t\t\t\t\taria-describedby={ `block-editor-block-mover__up-description-${ instanceId }` }\n\t\t\t\t\taria-disabled={ isFirst }\n\t\t\t\t\tonFocus={ this.onFocus }\n\t\t\t\t\tonBlur={ this.onBlur }\n\t\t\t\t/>\n\n\t\t\t\t{ ! hideDragHandle && (\n\t\t\t\t\t<BlockDraggable clientIds={ clientIds }>\n\t\t\t\t\t\t{ ( { onDraggableStart, onDraggableEnd } ) => (\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\ticon={ dragHandle }\n\t\t\t\t\t\t\t\tclassName=\"block-editor-block-mover__control-drag-handle block-editor-block-mover__control\"\n\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t// Should not be able to tab to drag handle as this\n\t\t\t\t\t\t\t\t// button can only be used with a pointer device.\n\t\t\t\t\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t\t\t\t\tonDragStart={ onDraggableStart }\n\t\t\t\t\t\t\t\tonDragEnd={ onDraggableEnd }\n\t\t\t\t\t\t\t\tdraggable\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</BlockDraggable>\n\t\t\t\t) }\n\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"block-editor-block-mover__control\"\n\t\t\t\t\tonClick={ isLast ? null : onMoveDown }\n\t\t\t\t\ticon={ getArrowIcon( 'down' ) }\n\t\t\t\t\tlabel={ getMovementDirectionLabel( 'down' ) }\n\t\t\t\t\taria-describedby={ `block-editor-block-mover__down-description-${ instanceId }` }\n\t\t\t\t\taria-disabled={ isLast }\n\t\t\t\t\tonFocus={ this.onFocus }\n\t\t\t\t\tonBlur={ this.onBlur }\n\t\t\t\t/>\n\t\t\t\t<span\n\t\t\t\t\tid={ `block-editor-block-mover__up-description-${ instanceId }` }\n\t\t\t\t\tclassName=\"block-editor-block-mover__description\"\n\t\t\t\t>\n\t\t\t\t\t{ getBlockMoverDescription(\n\t\t\t\t\t\tblocksCount,\n\t\t\t\t\t\tblockType && blockType.title,\n\t\t\t\t\t\tfirstIndex,\n\t\t\t\t\t\tisFirst,\n\t\t\t\t\t\tisLast,\n\t\t\t\t\t\t-1,\n\t\t\t\t\t\torientation,\n\t\t\t\t\t\tisRTL\n\t\t\t\t\t) }\n\t\t\t\t</span>\n\t\t\t\t<span\n\t\t\t\t\tid={ `block-editor-block-mover__down-description-${ instanceId }` }\n\t\t\t\t\tclassName=\"block-editor-block-mover__description\"\n\t\t\t\t>\n\t\t\t\t\t{ getBlockMoverDescription(\n\t\t\t\t\t\tblocksCount,\n\t\t\t\t\t\tblockType && blockType.title,\n\t\t\t\t\t\tfirstIndex,\n\t\t\t\t\t\tisFirst,\n\t\t\t\t\t\tisLast,\n\t\t\t\t\t\t1,\n\t\t\t\t\t\torientation,\n\t\t\t\t\t\tisRTL\n\t\t\t\t\t) }\n\t\t\t\t</span>\n\t\t\t</ToolbarGroup>\n\t\t);\n\t}\n}\n\nexport default compose(\n\twithSelect( ( select, { clientIds } ) => {\n\t\tconst {\n\t\t\tgetBlock,\n\t\t\tgetBlockIndex,\n\t\t\tgetTemplateLock,\n\t\t\tgetBlockRootClientId,\n\t\t\tgetBlockOrder,\n\t\t} = select( 'core/block-editor' );\n\t\tconst normalizedClientIds = castArray( clientIds );\n\t\tconst firstClientId = first( normalizedClientIds );\n\t\tconst block = getBlock( firstClientId );\n\t\tconst rootClientId = getBlockRootClientId(\n\t\t\tfirst( normalizedClientIds )\n\t\t);\n\t\tconst blockOrder = getBlockOrder( rootClientId );\n\t\tconst firstIndex = getBlockIndex( firstClientId, rootClientId );\n\t\tconst lastIndex = getBlockIndex(\n\t\t\tlast( normalizedClientIds ),\n\t\t\trootClientId\n\t\t);\n\t\tconst { getSettings } = select( 'core/block-editor' );\n\t\tconst { isRTL } = getSettings();\n\n\t\treturn {\n\t\t\tblockType: block ? getBlockType( block.name ) : null,\n\t\t\tisLocked: getTemplateLock( rootClientId ) === 'all',\n\t\t\trootClientId,\n\t\t\tfirstIndex,\n\t\t\tisRTL,\n\t\t\tisFirst: firstIndex === 0,\n\t\t\tisLast: lastIndex === blockOrder.length - 1,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { clientIds, rootClientId } ) => {\n\t\tconst { moveBlocksDown, moveBlocksUp } = dispatch(\n\t\t\t'core/block-editor'\n\t\t);\n\t\treturn {\n\t\t\tonMoveDown: partial( moveBlocksDown, clientIds, rootClientId ),\n\t\t\tonMoveUp: partial( moveBlocksUp, clientIds, rootClientId ),\n\t\t};\n\t} ),\n\twithInstanceId\n)( BlockMover );\n"]}