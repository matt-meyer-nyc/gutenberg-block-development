{"version":3,"sources":["@wordpress/block-editor/src/components/font-sizes/with-font-sizes.js"],"names":["fontSizeNames","fontSizeAttributeNames","fontSizeAttributeNamesAccumulator","fontSizeAttributeName","select","getSettings","fontSizes","WrappedComponent","props","setters","createSetters","state","settersAccumulator","customFontSizeAttributeName","upperFirstFontSizeAttributeName","createSetFontSize","fontSizeValue","fontSizeObject","size","Number","setAttributes","slug","undefined","previousState","attributes","didAttributesChange","newState","newStateAccumulator","fontSizeAttributeValue","class","Component"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { find, pickBy, reduce, some, upperFirst } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { createHigherOrderComponent, compose } from '@wordpress/compose';\nimport { Component } from '@wordpress/element';\nimport { withSelect } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport { getFontSize, getFontSizeClass } from './utils';\n\n/**\n * Higher-order component, which handles font size logic for class generation,\n * font size value retrieval, and font size change handling.\n *\n * @param {...(Object|string)} fontSizeNames The arguments should all be strings.\n *                                           Each string contains the font size\n *                                           attribute name e.g: 'fontSize'.\n *\n * @return {Function} Higher-order component.\n */\nexport default ( ...fontSizeNames ) => {\n\t/*\n\t * Computes an object whose key is the font size attribute name as passed in the array,\n\t * and the value is the custom font size attribute name.\n\t * Custom font size is automatically compted by appending custom followed by the font size attribute name in with the first letter capitalized.\n\t */\n\tconst fontSizeAttributeNames = reduce(\n\t\tfontSizeNames,\n\t\t( fontSizeAttributeNamesAccumulator, fontSizeAttributeName ) => {\n\t\t\tfontSizeAttributeNamesAccumulator[\n\t\t\t\tfontSizeAttributeName\n\t\t\t] = `custom${ upperFirst( fontSizeAttributeName ) }`;\n\t\t\treturn fontSizeAttributeNamesAccumulator;\n\t\t},\n\t\t{}\n\t);\n\n\treturn createHigherOrderComponent(\n\t\tcompose( [\n\t\t\twithSelect( ( select ) => {\n\t\t\t\tconst { fontSizes } = select(\n\t\t\t\t\t'core/block-editor'\n\t\t\t\t).getSettings();\n\t\t\t\treturn {\n\t\t\t\t\tfontSizes,\n\t\t\t\t};\n\t\t\t} ),\n\t\t\t( WrappedComponent ) => {\n\t\t\t\treturn class extends Component {\n\t\t\t\t\tconstructor( props ) {\n\t\t\t\t\t\tsuper( props );\n\n\t\t\t\t\t\tthis.setters = this.createSetters();\n\n\t\t\t\t\t\tthis.state = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tcreateSetters() {\n\t\t\t\t\t\treturn reduce(\n\t\t\t\t\t\t\tfontSizeAttributeNames,\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tsettersAccumulator,\n\t\t\t\t\t\t\t\tcustomFontSizeAttributeName,\n\t\t\t\t\t\t\t\tfontSizeAttributeName\n\t\t\t\t\t\t\t) => {\n\t\t\t\t\t\t\t\tconst upperFirstFontSizeAttributeName = upperFirst(\n\t\t\t\t\t\t\t\t\tfontSizeAttributeName\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tsettersAccumulator[\n\t\t\t\t\t\t\t\t\t`set${ upperFirstFontSizeAttributeName }`\n\t\t\t\t\t\t\t\t] = this.createSetFontSize(\n\t\t\t\t\t\t\t\t\tfontSizeAttributeName,\n\t\t\t\t\t\t\t\t\tcustomFontSizeAttributeName\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\treturn settersAccumulator;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tcreateSetFontSize(\n\t\t\t\t\t\tfontSizeAttributeName,\n\t\t\t\t\t\tcustomFontSizeAttributeName\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn ( fontSizeValue ) => {\n\t\t\t\t\t\t\tconst fontSizeObject = find( this.props.fontSizes, {\n\t\t\t\t\t\t\t\tsize: Number( fontSizeValue ),\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\tthis.props.setAttributes( {\n\t\t\t\t\t\t\t\t[ fontSizeAttributeName ]:\n\t\t\t\t\t\t\t\t\tfontSizeObject && fontSizeObject.slug\n\t\t\t\t\t\t\t\t\t\t? fontSizeObject.slug\n\t\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\t\t[ customFontSizeAttributeName ]:\n\t\t\t\t\t\t\t\t\tfontSizeObject && fontSizeObject.slug\n\t\t\t\t\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t\t\t\t\t: fontSizeValue,\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\tstatic getDerivedStateFromProps(\n\t\t\t\t\t\t{ attributes, fontSizes },\n\t\t\t\t\t\tpreviousState\n\t\t\t\t\t) {\n\t\t\t\t\t\tconst didAttributesChange = (\n\t\t\t\t\t\t\tcustomFontSizeAttributeName,\n\t\t\t\t\t\t\tfontSizeAttributeName\n\t\t\t\t\t\t) => {\n\t\t\t\t\t\t\tif ( previousState[ fontSizeAttributeName ] ) {\n\t\t\t\t\t\t\t\t// if new font size is name compare with the previous slug\n\t\t\t\t\t\t\t\tif ( attributes[ fontSizeAttributeName ] ) {\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\tattributes[ fontSizeAttributeName ] !==\n\t\t\t\t\t\t\t\t\t\tpreviousState[ fontSizeAttributeName ]\n\t\t\t\t\t\t\t\t\t\t\t.slug\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// if font size is not named, update when the font size value changes.\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\tpreviousState[ fontSizeAttributeName ]\n\t\t\t\t\t\t\t\t\t\t.size !==\n\t\t\t\t\t\t\t\t\tattributes[ customFontSizeAttributeName ]\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// in this case we need to build the font size object\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t! some(\n\t\t\t\t\t\t\t\tfontSizeAttributeNames,\n\t\t\t\t\t\t\t\tdidAttributesChange\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst newState = reduce(\n\t\t\t\t\t\t\tpickBy(\n\t\t\t\t\t\t\t\tfontSizeAttributeNames,\n\t\t\t\t\t\t\t\tdidAttributesChange\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tnewStateAccumulator,\n\t\t\t\t\t\t\t\tcustomFontSizeAttributeName,\n\t\t\t\t\t\t\t\tfontSizeAttributeName\n\t\t\t\t\t\t\t) => {\n\t\t\t\t\t\t\t\tconst fontSizeAttributeValue =\n\t\t\t\t\t\t\t\t\tattributes[ fontSizeAttributeName ];\n\t\t\t\t\t\t\t\tconst fontSizeObject = getFontSize(\n\t\t\t\t\t\t\t\t\tfontSizes,\n\t\t\t\t\t\t\t\t\tfontSizeAttributeValue,\n\t\t\t\t\t\t\t\t\tattributes[ customFontSizeAttributeName ]\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tnewStateAccumulator[ fontSizeAttributeName ] = {\n\t\t\t\t\t\t\t\t\t...fontSizeObject,\n\t\t\t\t\t\t\t\t\tclass: getFontSizeClass(\n\t\t\t\t\t\t\t\t\t\tfontSizeAttributeValue\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\treturn newStateAccumulator;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...previousState,\n\t\t\t\t\t\t\t...newState,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\trender() {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<WrappedComponent\n\t\t\t\t\t\t\t\t{ ...{\n\t\t\t\t\t\t\t\t\t...this.props,\n\t\t\t\t\t\t\t\t\tfontSizes: undefined,\n\t\t\t\t\t\t\t\t\t...this.state,\n\t\t\t\t\t\t\t\t\t...this.setters,\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\t\t] ),\n\t\t'withFontSizes'\n\t);\n};\n"]}