{"version":3,"sources":["@wordpress/editor/src/components/convert-to-group-buttons/convert-button.js"],"names":["ConvertToGroupButton","onConvertToGroup","onConvertFromGroup","isGroupable","isUngroupable","Group","Ungroup","select","clientIds","getBlockRootClientId","getBlocksByClientId","canInsertBlockType","getGroupingBlockName","groupingBlockName","rootClientId","length","undefined","groupingBlockAvailable","blocksSelection","isSingleGroupingBlock","name","innerBlocks","dispatch","onToggle","noop","replaceBlocks","newBlocks"],"mappings":";;;;;;;;AAQA;;AALA;;AAMA;;AACA;;AACA;;AACA;;AACA;;AAKA;;AAlBA;;;;AAKA;;;;AAUA;;;AAKO,SAASA,oBAAT,OAKH;AAAA,MAJHC,gBAIG,QAJHA,gBAIG;AAAA,MAHHC,kBAGG,QAHHA,kBAGG;AAAA,8BAFHC,WAEG;AAAA,MAFHA,WAEG,iCAFW,KAEX;AAAA,gCADHC,aACG;AAAA,MADHA,aACG,mCADa,KACb;AACH,SACC,4BAAC,iBAAD,QACGD,WAAW,IACZ,4BAAC,oBAAD;AAAU,IAAA,IAAI,EAAGE,YAAjB;AAAyB,IAAA,OAAO,EAAGJ;AAAnC,KACG,cAAI,OAAJ,EAAa,MAAb,CADH,CAFF,EAMGG,aAAa,IACd,4BAAC,oBAAD;AAAU,IAAA,IAAI,EAAGE,cAAjB;AAA2B,IAAA,OAAO,EAAGJ;AAArC,KACG,cACD,SADC,EAED,4FAFC,CADH,CAPF,CADD;AAiBA;;eAEc,sBAAS,CACvB,sBAAY,UAAEK,MAAF,SAA6B;AAAA,MAAjBC,SAAiB,SAAjBA,SAAiB;;AAAA,gBAKpCD,MAAM,CAAE,mBAAF,CAL8B;AAAA,MAEvCE,oBAFuC,WAEvCA,oBAFuC;AAAA,MAGvCC,mBAHuC,WAGvCA,mBAHuC;AAAA,MAIvCC,kBAJuC,WAIvCA,kBAJuC;;AAAA,iBAOPJ,MAAM,CAAE,aAAF,CAPC;AAAA,MAOhCK,oBAPgC,YAOhCA,oBAPgC;;AASxC,MAAMC,iBAAiB,GAAGD,oBAAoB,EAA9C;AAEA,MAAME,YAAY,GACjBN,SAAS,IAAIA,SAAS,CAACO,MAAV,GAAmB,CAAhC,GACGN,oBAAoB,CAAED,SAAS,CAAE,CAAF,CAAX,CADvB,GAEGQ,SAHJ;AAKA,MAAMC,sBAAsB,GAAGN,kBAAkB,CAChDE,iBADgD,EAEhDC,YAFgD,CAAjD;AAKA,MAAMI,eAAe,GAAGR,mBAAmB,CAAEF,SAAF,CAA3C;AAEA,MAAMW,qBAAqB,GAC1BD,eAAe,CAACH,MAAhB,KAA2B,CAA3B,IACAG,eAAe,CAAE,CAAF,CADf,IAEAA,eAAe,CAAE,CAAF,CAAf,CAAqBE,IAArB,KAA8BP,iBAH/B,CAvBwC,CA4BxC;AACA;AACA;AACA;AACA;;AACA,MAAMV,WAAW,GAChBc,sBAAsB,IACtBC,eAAe,CAACH,MADhB,IAEA,CAAEI,qBAHH,CAjCwC,CAsCxC;;AACA,MAAMf,aAAa,GAClBe,qBAAqB,IAAI,CAAC,CAAED,eAAe,CAAE,CAAF,CAAf,CAAqBG,WAArB,CAAiCN,MAD9D;AAGA,SAAO;AACNZ,IAAAA,WAAW,EAAXA,WADM;AAENC,IAAAA,aAAa,EAAbA,aAFM;AAGNc,IAAAA,eAAe,EAAfA,eAHM;AAINL,IAAAA,iBAAiB,EAAjBA;AAJM,GAAP;AAMA,CAhDD,CADuB,EAkDvB,wBACC,UACCS,QADD,SAQK;AAAA,MALHd,SAKG,SALHA,SAKG;AAAA,6BAJHe,QAIG;AAAA,MAJHA,QAIG,+BAJQC,YAIR;AAAA,oCAHHN,eAGG;AAAA,MAHHA,eAGG,sCAHe,EAGf;AAAA,MAFHL,iBAEG,SAFHA,iBAEG;;AAAA,kBACsBS,QAAQ,CAAE,mBAAF,CAD9B;AAAA,MACIG,aADJ,aACIA,aADJ;;AAGJ,SAAO;AACNxB,IAAAA,gBADM,8BACa;AAClB,UAAK,CAAEiB,eAAe,CAACH,MAAvB,EAAgC;AAC/B;AACA,OAHiB,CAKlB;;;AACA,UAAMW,SAAS,GAAG,+BACjBR,eADiB,EAEjBL,iBAFiB,CAAlB;;AAKA,UAAKa,SAAL,EAAiB;AAChBD,QAAAA,aAAa,CAAEjB,SAAF,EAAakB,SAAb,CAAb;AACA;;AAEDH,MAAAA,QAAQ;AACR,KAjBK;AAkBNrB,IAAAA,kBAlBM,gCAkBe;AACpB,UAAK,CAAEgB,eAAe,CAACH,MAAvB,EAAgC;AAC/B;AACA;;AAED,UAAMM,WAAW,GAAGH,eAAe,CAAE,CAAF,CAAf,CAAqBG,WAAzC;;AAEA,UAAK,CAAEA,WAAW,CAACN,MAAnB,EAA4B;AAC3B;AACA;;AAEDU,MAAAA,aAAa,CAAEjB,SAAF,EAAaa,WAAb,CAAb;AAEAE,MAAAA,QAAQ;AACR;AAhCK,GAAP;AAkCA,CA9CF,CAlDuB,CAAT,EAkGVvB,oBAlGU,C","sourcesContent":["/**\n * External dependencies\n */\nimport { noop } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Fragment } from '@wordpress/element';\nimport { MenuItem } from '@wordpress/components';\nimport { _x } from '@wordpress/i18n';\nimport { switchToBlockType } from '@wordpress/blocks';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { Group, Ungroup } from './icons';\n\nexport function ConvertToGroupButton( {\n\tonConvertToGroup,\n\tonConvertFromGroup,\n\tisGroupable = false,\n\tisUngroupable = false,\n} ) {\n\treturn (\n\t\t<Fragment>\n\t\t\t{ isGroupable && (\n\t\t\t\t<MenuItem icon={ Group } onClick={ onConvertToGroup }>\n\t\t\t\t\t{ _x( 'Group', 'verb' ) }\n\t\t\t\t</MenuItem>\n\t\t\t) }\n\t\t\t{ isUngroupable && (\n\t\t\t\t<MenuItem icon={ Ungroup } onClick={ onConvertFromGroup }>\n\t\t\t\t\t{ _x(\n\t\t\t\t\t\t'Ungroup',\n\t\t\t\t\t\t'Ungrouping blocks from within a Group block back into individual blocks within the Editor '\n\t\t\t\t\t) }\n\t\t\t\t</MenuItem>\n\t\t\t) }\n\t\t</Fragment>\n\t);\n}\n\nexport default compose( [\n\twithSelect( ( select, { clientIds } ) => {\n\t\tconst {\n\t\t\tgetBlockRootClientId,\n\t\t\tgetBlocksByClientId,\n\t\t\tcanInsertBlockType,\n\t\t} = select( 'core/block-editor' );\n\n\t\tconst { getGroupingBlockName } = select( 'core/blocks' );\n\n\t\tconst groupingBlockName = getGroupingBlockName();\n\n\t\tconst rootClientId =\n\t\t\tclientIds && clientIds.length > 0\n\t\t\t\t? getBlockRootClientId( clientIds[ 0 ] )\n\t\t\t\t: undefined;\n\n\t\tconst groupingBlockAvailable = canInsertBlockType(\n\t\t\tgroupingBlockName,\n\t\t\trootClientId\n\t\t);\n\n\t\tconst blocksSelection = getBlocksByClientId( clientIds );\n\n\t\tconst isSingleGroupingBlock =\n\t\t\tblocksSelection.length === 1 &&\n\t\t\tblocksSelection[ 0 ] &&\n\t\t\tblocksSelection[ 0 ].name === groupingBlockName;\n\n\t\t// Do we have\n\t\t// 1. Grouping block available to be inserted?\n\t\t// 2. One or more blocks selected\n\t\t// (we allow single Blocks to become groups unless\n\t\t// they are a soltiary group block themselves)\n\t\tconst isGroupable =\n\t\t\tgroupingBlockAvailable &&\n\t\t\tblocksSelection.length &&\n\t\t\t! isSingleGroupingBlock;\n\n\t\t// Do we have a single Group Block selected and does that group have inner blocks?\n\t\tconst isUngroupable =\n\t\t\tisSingleGroupingBlock && !! blocksSelection[ 0 ].innerBlocks.length;\n\n\t\treturn {\n\t\t\tisGroupable,\n\t\t\tisUngroupable,\n\t\t\tblocksSelection,\n\t\t\tgroupingBlockName,\n\t\t};\n\t} ),\n\twithDispatch(\n\t\t(\n\t\t\tdispatch,\n\t\t\t{\n\t\t\t\tclientIds,\n\t\t\t\tonToggle = noop,\n\t\t\t\tblocksSelection = [],\n\t\t\t\tgroupingBlockName,\n\t\t\t}\n\t\t) => {\n\t\t\tconst { replaceBlocks } = dispatch( 'core/block-editor' );\n\n\t\t\treturn {\n\t\t\t\tonConvertToGroup() {\n\t\t\t\t\tif ( ! blocksSelection.length ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Activate the `transform` on the Grouping Block which does the conversion\n\t\t\t\t\tconst newBlocks = switchToBlockType(\n\t\t\t\t\t\tblocksSelection,\n\t\t\t\t\t\tgroupingBlockName\n\t\t\t\t\t);\n\n\t\t\t\t\tif ( newBlocks ) {\n\t\t\t\t\t\treplaceBlocks( clientIds, newBlocks );\n\t\t\t\t\t}\n\n\t\t\t\t\tonToggle();\n\t\t\t\t},\n\t\t\t\tonConvertFromGroup() {\n\t\t\t\t\tif ( ! blocksSelection.length ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst innerBlocks = blocksSelection[ 0 ].innerBlocks;\n\n\t\t\t\t\tif ( ! innerBlocks.length ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\treplaceBlocks( clientIds, innerBlocks );\n\n\t\t\t\t\tonToggle();\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\t),\n] )( ConvertToGroupButton );\n"]}