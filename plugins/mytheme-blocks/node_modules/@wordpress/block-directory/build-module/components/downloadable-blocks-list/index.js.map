{"version":3,"sources":["@wordpress/block-directory/src/components/downloadable-blocks-list/index.js"],"names":["noop","getBlockMenuDefaultClassName","unregisterBlockType","withDispatch","compose","__","DownloadableBlockListItem","DOWNLOAD_ERROR_NOTICE_ID","INSTALL_ERROR_NOTICE_ID","DownloadableBlocksList","items","onHover","children","downloadAndInstallBlock","map","item","id","icons","dispatch","props","installBlock","downloadBlock","createErrorNotice","removeNotice","removeBlocks","onSelect","onDownloadError","actions","label","onClick","onSuccess","createdBlock","onInstallBlockError","clientId","name"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { noop } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tgetBlockMenuDefaultClassName,\n\tunregisterBlockType,\n} from '@wordpress/blocks';\nimport { withDispatch } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport DownloadableBlockListItem from '../downloadable-block-list-item';\n\nconst DOWNLOAD_ERROR_NOTICE_ID = 'block-download-error';\nconst INSTALL_ERROR_NOTICE_ID = 'block-install-error';\n\nfunction DownloadableBlocksList( {\n\titems,\n\tonHover = noop,\n\tchildren,\n\tdownloadAndInstallBlock,\n} ) {\n\treturn (\n\t\t/*\n\t\t * Disable reason: The `list` ARIA role is redundant but\n\t\t * Safari+VoiceOver won't announce the list otherwise.\n\t\t */\n\t\t/* eslint-disable jsx-a11y/no-redundant-roles */\n\t\t<ul role=\"list\" className=\"block-directory-downloadable-blocks-list\">\n\t\t\t{ items &&\n\t\t\t\titems.map( ( item ) => (\n\t\t\t\t\t<DownloadableBlockListItem\n\t\t\t\t\t\tkey={ item.id }\n\t\t\t\t\t\tclassName={ getBlockMenuDefaultClassName( item.id ) }\n\t\t\t\t\t\ticons={ item.icons }\n\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\tdownloadAndInstallBlock( item );\n\t\t\t\t\t\t\tonHover( null );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonFocus={ () => onHover( item ) }\n\t\t\t\t\t\tonMouseEnter={ () => onHover( item ) }\n\t\t\t\t\t\tonMouseLeave={ () => onHover( null ) }\n\t\t\t\t\t\tonBlur={ () => onHover( null ) }\n\t\t\t\t\t\titem={ item }\n\t\t\t\t\t/>\n\t\t\t\t) ) }\n\t\t\t{ children }\n\t\t</ul>\n\t\t/* eslint-enable jsx-a11y/no-redundant-roles */\n\t);\n}\n\nexport default compose(\n\twithDispatch( ( dispatch, props ) => {\n\t\tconst { installBlock, downloadBlock } = dispatch(\n\t\t\t'core/block-directory'\n\t\t);\n\t\tconst { createErrorNotice, removeNotice } = dispatch( 'core/notices' );\n\t\tconst { removeBlocks } = dispatch( 'core/block-editor' );\n\t\tconst { onSelect } = props;\n\n\t\treturn {\n\t\t\tdownloadAndInstallBlock: ( item ) => {\n\t\t\t\tconst onDownloadError = () => {\n\t\t\t\t\tcreateErrorNotice( __( 'Block previews canâ€™t load.' ), {\n\t\t\t\t\t\tid: DOWNLOAD_ERROR_NOTICE_ID,\n\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: __( 'Retry' ),\n\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\tremoveNotice( DOWNLOAD_ERROR_NOTICE_ID );\n\t\t\t\t\t\t\t\t\tdownloadBlock(\n\t\t\t\t\t\t\t\t\t\titem,\n\t\t\t\t\t\t\t\t\t\tonSuccess,\n\t\t\t\t\t\t\t\t\t\tonDownloadError\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t} );\n\t\t\t\t};\n\n\t\t\t\tconst onSuccess = () => {\n\t\t\t\t\tconst createdBlock = onSelect( item );\n\n\t\t\t\t\tconst onInstallBlockError = () => {\n\t\t\t\t\t\tcreateErrorNotice(\n\t\t\t\t\t\t\t__( \"Block previews can't install.\" ),\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: INSTALL_ERROR_NOTICE_ID,\n\t\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel: __( 'Retry' ),\n\t\t\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\t\t\tremoveNotice(\n\t\t\t\t\t\t\t\t\t\t\t\tINSTALL_ERROR_NOTICE_ID\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\tinstallBlock(\n\t\t\t\t\t\t\t\t\t\t\t\titem,\n\t\t\t\t\t\t\t\t\t\t\t\tnoop,\n\t\t\t\t\t\t\t\t\t\t\t\tonInstallBlockError\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel: __( 'Remove' ),\n\t\t\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\t\t\tremoveNotice(\n\t\t\t\t\t\t\t\t\t\t\t\tINSTALL_ERROR_NOTICE_ID\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\tremoveBlocks(\n\t\t\t\t\t\t\t\t\t\t\t\tcreatedBlock.clientId\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\tunregisterBlockType( item.name );\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t};\n\n\t\t\t\t\tinstallBlock( item, noop, onInstallBlockError );\n\t\t\t\t};\n\n\t\t\t\tdownloadBlock( item, onSuccess, onDownloadError );\n\t\t\t},\n\t\t};\n\t} )\n)( DownloadableBlocksList );\n"]}