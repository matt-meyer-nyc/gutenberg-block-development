{"version":3,"sources":["@wordpress/block-editor/src/components/block-list/index.js"],"names":["classnames","AsyncModeProvider","useSelect","useRef","BlockListBlock","BlockListAppender","__experimentalBlockListFooter","RootContainer","useBlockDropZone","BLOCK_ANIMATION_THRESHOLD","forceSyncUpdates","WrappedComponent","props","BlockList","className","rootClientId","isDraggable","renderAppender","__experimentalUIParts","selector","select","getBlockOrder","isMultiSelecting","getSelectedBlockClientId","getMultiSelectedBlockClientIds","hasMultiSelection","getGlobalBlockCount","isTyping","blockClientIds","selectedBlockClientId","multiSelectedBlockClientIds","enableAnimation","Container","ref","targetClientId","element","__experimentalContainerProps","hasPopover","map","clientId","index","isBlockInSelection","includes","hasSelectedUI","undefined"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { AsyncModeProvider, useSelect } from '@wordpress/data';\nimport { useRef } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport BlockListBlock from './block';\nimport BlockListAppender from '../block-list-appender';\nimport __experimentalBlockListFooter from '../block-list-footer';\nimport RootContainer from './root-container';\nimport useBlockDropZone from '../block-drop-zone';\n\n/**\n * If the block count exceeds the threshold, we disable the reordering animation\n * to avoid laginess.\n */\nconst BLOCK_ANIMATION_THRESHOLD = 200;\n\nconst forceSyncUpdates = ( WrappedComponent ) => ( props ) => {\n\treturn (\n\t\t<AsyncModeProvider value={ false }>\n\t\t\t<WrappedComponent { ...props } />\n\t\t</AsyncModeProvider>\n\t);\n};\n\nfunction BlockList( {\n\tclassName,\n\trootClientId,\n\tisDraggable,\n\trenderAppender,\n\t__experimentalUIParts = {},\n} ) {\n\tfunction selector( select ) {\n\t\tconst {\n\t\t\tgetBlockOrder,\n\t\t\tisMultiSelecting,\n\t\t\tgetSelectedBlockClientId,\n\t\t\tgetMultiSelectedBlockClientIds,\n\t\t\thasMultiSelection,\n\t\t\tgetGlobalBlockCount,\n\t\t\tisTyping,\n\t\t} = select( 'core/block-editor' );\n\n\t\treturn {\n\t\t\tblockClientIds: getBlockOrder( rootClientId ),\n\t\t\tisMultiSelecting: isMultiSelecting(),\n\t\t\tselectedBlockClientId: getSelectedBlockClientId(),\n\t\t\tmultiSelectedBlockClientIds: getMultiSelectedBlockClientIds(),\n\t\t\thasMultiSelection: hasMultiSelection(),\n\t\t\tenableAnimation:\n\t\t\t\t! isTyping() &&\n\t\t\t\tgetGlobalBlockCount() <= BLOCK_ANIMATION_THRESHOLD,\n\t\t};\n\t}\n\n\tconst {\n\t\tblockClientIds,\n\t\tisMultiSelecting,\n\t\tselectedBlockClientId,\n\t\tmultiSelectedBlockClientIds,\n\t\thasMultiSelection,\n\t\tenableAnimation,\n\t} = useSelect( selector, [ rootClientId ] );\n\n\tconst Container = rootClientId ? 'div' : RootContainer;\n\tconst ref = useRef();\n\tconst targetClientId = useBlockDropZone( {\n\t\telement: ref,\n\t\trootClientId,\n\t} );\n\tconst __experimentalContainerProps = rootClientId\n\t\t? {}\n\t\t: { hasPopover: __experimentalUIParts.hasPopover };\n\n\treturn (\n\t\t<Container\n\t\t\tref={ ref }\n\t\t\tclassName={ classnames(\n\t\t\t\t'block-editor-block-list__layout',\n\t\t\t\tclassName\n\t\t\t) }\n\t\t\t{ ...__experimentalContainerProps }\n\t\t>\n\t\t\t{ blockClientIds.map( ( clientId, index ) => {\n\t\t\t\tconst isBlockInSelection = hasMultiSelection\n\t\t\t\t\t? multiSelectedBlockClientIds.includes( clientId )\n\t\t\t\t\t: selectedBlockClientId === clientId;\n\n\t\t\t\treturn (\n\t\t\t\t\t<AsyncModeProvider\n\t\t\t\t\t\tkey={ clientId }\n\t\t\t\t\t\tvalue={ ! isBlockInSelection }\n\t\t\t\t\t>\n\t\t\t\t\t\t<BlockListBlock\n\t\t\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\tisDraggable={ isDraggable }\n\t\t\t\t\t\t\tisMultiSelecting={ isMultiSelecting }\n\t\t\t\t\t\t\t// This prop is explicitely computed and passed down\n\t\t\t\t\t\t\t// to avoid being impacted by the async mode\n\t\t\t\t\t\t\t// otherwise there might be a small delay to trigger the animation.\n\t\t\t\t\t\t\tanimateOnChange={ index }\n\t\t\t\t\t\t\tenableAnimation={ enableAnimation }\n\t\t\t\t\t\t\thasSelectedUI={\n\t\t\t\t\t\t\t\t__experimentalUIParts.hasSelectedUI\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\tclientId === targetClientId\n\t\t\t\t\t\t\t\t\t? 'is-drop-target'\n\t\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</AsyncModeProvider>\n\t\t\t\t);\n\t\t\t} ) }\n\t\t\t<BlockListAppender\n\t\t\t\trootClientId={ rootClientId }\n\t\t\t\trenderAppender={ renderAppender }\n\t\t\t\tclassName={\n\t\t\t\t\ttargetClientId === null ? 'is-drop-target' : undefined\n\t\t\t\t}\n\t\t\t/>\n\t\t\t<__experimentalBlockListFooter.Slot />\n\t\t</Container>\n\t);\n}\n\n// This component needs to always be synchronous\n// as it's the one changing the async mode\n// depending on the block selection.\nexport default forceSyncUpdates( BlockList );\n"]}