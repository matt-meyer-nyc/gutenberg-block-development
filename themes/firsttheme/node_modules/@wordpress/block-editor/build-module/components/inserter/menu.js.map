{"version":3,"sources":["@wordpress/block-editor/src/components/inserter/menu.js"],"names":["filter","findIndex","flow","groupBy","isEmpty","map","sortBy","without","includes","scrollIntoView","classnames","speak","__","_n","_x","sprintf","Component","__experimentalCreateInterpolateElement","createRef","PanelBody","withSpokenMessages","Tip","isReusableBlock","createBlock","isUnmodifiedDefaultBlock","getBlockType","getBlockFromExample","withDispatch","withSelect","withInstanceId","compose","withSafeTimeout","LEFT","RIGHT","UP","DOWN","BACKSPACE","ENTER","addQueryArgs","BlockPreview","BlockTypesList","BlockCard","ChildBlocks","__experimentalInserterMenuExtension","searchItems","MAX_SUGGESTED_ITEMS","stopKeyPropagation","event","stopPropagation","getBlockNamespace","item","name","split","createBlocksFromInnerBlocksTemplate","innerBlocksTemplate","attributes","innerBlocks","InserterMenu","arguments","state","childItems","filterValue","hoveredItem","suggestedItems","reusableItems","itemsPerCategory","itemsPerCollection","openPanels","onChangeSearchInput","bind","onHover","panels","inserterResults","props","fetchReusableBlocks","prevProps","items","target","value","setState","showInsertionPoint","hideInsertionPoint","ref","panel","isOpened","indexOf","setTimeout","current","alignWithTop","filteredItems","length","push","concat","Object","keys","categories","collections","debouncedSpeak","rootChildBlocks","maxSuggestedItems","utility","slice","category","getCategoryIndex","slug","itemList","forEach","namespace","filterOpenPanels","resultCount","reduce","accumulator","currentCategorySlug","resultsFoundMessage","keyCode","instanceId","onSelect","rootClientId","showInserterHelpPanel","isPanelOpen","hasItems","hoveredItemBlockType","hasHelpPanel","onKeyDown","onTogglePanel","bindPanel","categoryItems","title","icon","collection","collectionItems","post_type","fills","example","initialAttributes","kbd","select","clientId","isAppender","getInserterItems","getBlockName","getBlockRootClientId","getBlockSelectionEnd","getSettings","getCategories","getCollections","getChildBlockNames","destinationRootClientId","end","undefined","destinationRootBlockName","showInserterHelpPanelSetting","__experimentalFetchReusableBlocks","dispatch","ownProps","getInsertionIndex","getBlockIndex","getBlockOrder","index","replaceBlocks","insertBlock","getSelectedBlock","selectBlockOnInsert","__experimentalSelectBlockOnInsert","selectedBlock","insertedBlock","message"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport {\n\tfilter,\n\tfindIndex,\n\tflow,\n\tgroupBy,\n\tisEmpty,\n\tmap,\n\tsortBy,\n\twithout,\n\tincludes,\n} from 'lodash';\nimport scrollIntoView from 'dom-scroll-into-view';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { speak } from '@wordpress/a11y';\nimport { __, _n, _x, sprintf } from '@wordpress/i18n';\nimport {\n\tComponent,\n\t__experimentalCreateInterpolateElement,\n\tcreateRef,\n} from '@wordpress/element';\nimport { PanelBody, withSpokenMessages, Tip } from '@wordpress/components';\nimport {\n\tisReusableBlock,\n\tcreateBlock,\n\tisUnmodifiedDefaultBlock,\n\tgetBlockType,\n\tgetBlockFromExample,\n} from '@wordpress/blocks';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { withInstanceId, compose, withSafeTimeout } from '@wordpress/compose';\nimport { LEFT, RIGHT, UP, DOWN, BACKSPACE, ENTER } from '@wordpress/keycodes';\nimport { addQueryArgs } from '@wordpress/url';\n\n/**\n * Internal dependencies\n */\nimport BlockPreview from '../block-preview';\nimport BlockTypesList from '../block-types-list';\nimport BlockCard from '../block-card';\nimport ChildBlocks from './child-blocks';\nimport __experimentalInserterMenuExtension from '../inserter-menu-extension';\nimport { searchItems } from './search-items';\n\nconst MAX_SUGGESTED_ITEMS = 9;\n\nconst stopKeyPropagation = ( event ) => event.stopPropagation();\n\nconst getBlockNamespace = ( item ) => item.name.split( '/' )[ 0 ];\n\n// Copied over from the Columns block. It seems like it should become part of public API.\nconst createBlocksFromInnerBlocksTemplate = ( innerBlocksTemplate ) => {\n\treturn map(\n\t\tinnerBlocksTemplate,\n\t\t( [ name, attributes, innerBlocks = [] ] ) =>\n\t\t\tcreateBlock(\n\t\t\t\tname,\n\t\t\t\tattributes,\n\t\t\t\tcreateBlocksFromInnerBlocksTemplate( innerBlocks )\n\t\t\t)\n\t);\n};\n\nexport class InserterMenu extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.state = {\n\t\t\tchildItems: [],\n\t\t\tfilterValue: '',\n\t\t\thoveredItem: null,\n\t\t\tsuggestedItems: [],\n\t\t\treusableItems: [],\n\t\t\titemsPerCategory: {},\n\t\t\titemsPerCollection: {},\n\t\t\topenPanels: [ 'suggested' ],\n\t\t};\n\t\tthis.onChangeSearchInput = this.onChangeSearchInput.bind( this );\n\t\tthis.onHover = this.onHover.bind( this );\n\t\tthis.panels = {};\n\t\tthis.inserterResults = createRef();\n\t}\n\n\tcomponentDidMount() {\n\t\tif ( this.props.fetchReusableBlocks ) {\n\t\t\tthis.props.fetchReusableBlocks();\n\t\t}\n\t\tthis.filter();\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tif ( prevProps.items !== this.props.items ) {\n\t\t\tthis.filter( this.state.filterValue );\n\t\t}\n\t}\n\n\tonChangeSearchInput( event ) {\n\t\tthis.filter( event.target.value );\n\t}\n\n\tonHover( item ) {\n\t\tthis.setState( {\n\t\t\thoveredItem: item,\n\t\t} );\n\n\t\tconst { showInsertionPoint, hideInsertionPoint } = this.props;\n\t\tif ( item ) {\n\t\t\tshowInsertionPoint();\n\t\t} else {\n\t\t\thideInsertionPoint();\n\t\t}\n\t}\n\n\tbindPanel( name ) {\n\t\treturn ( ref ) => {\n\t\t\tthis.panels[ name ] = ref;\n\t\t};\n\t}\n\n\tonTogglePanel( panel ) {\n\t\treturn () => {\n\t\t\tconst isOpened = this.state.openPanels.indexOf( panel ) !== -1;\n\t\t\tif ( isOpened ) {\n\t\t\t\tthis.setState( {\n\t\t\t\t\topenPanels: without( this.state.openPanels, panel ),\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tthis.setState( {\n\t\t\t\t\topenPanels: [ ...this.state.openPanels, panel ],\n\t\t\t\t} );\n\n\t\t\t\tthis.props.setTimeout( () => {\n\t\t\t\t\t// We need a generic way to access the panel's container\n\t\t\t\t\tscrollIntoView(\n\t\t\t\t\t\tthis.panels[ panel ],\n\t\t\t\t\t\tthis.inserterResults.current,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\talignWithTop: true,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t}\n\n\tfilterOpenPanels(\n\t\tfilterValue,\n\t\titemsPerCategory,\n\t\titemsPerCollection,\n\t\tfilteredItems,\n\t\treusableItems\n\t) {\n\t\tif ( filterValue === this.state.filterValue ) {\n\t\t\treturn this.state.openPanels;\n\t\t}\n\t\tif ( ! filterValue ) {\n\t\t\treturn [ 'suggested' ];\n\t\t}\n\t\tlet openPanels = [];\n\t\tif ( reusableItems.length > 0 ) {\n\t\t\topenPanels.push( 'reusable' );\n\t\t}\n\t\tif ( filteredItems.length > 0 ) {\n\t\t\topenPanels = openPanels.concat(\n\t\t\t\tObject.keys( itemsPerCategory ),\n\t\t\t\tObject.keys( itemsPerCollection )\n\t\t\t);\n\t\t}\n\n\t\treturn openPanels;\n\t}\n\n\tfilter( filterValue = '' ) {\n\t\tconst {\n\t\t\tcategories,\n\t\t\tcollections,\n\t\t\tdebouncedSpeak,\n\t\t\titems,\n\t\t\trootChildBlocks,\n\t\t} = this.props;\n\n\t\tconst filteredItems = searchItems(\n\t\t\titems,\n\t\t\tcategories,\n\t\t\tcollections,\n\t\t\tfilterValue\n\t\t);\n\n\t\tconst childItems = filter( filteredItems, ( { name } ) =>\n\t\t\tincludes( rootChildBlocks, name )\n\t\t);\n\n\t\tlet suggestedItems = [];\n\t\tif ( ! filterValue ) {\n\t\t\tconst maxSuggestedItems =\n\t\t\t\tthis.props.maxSuggestedItems || MAX_SUGGESTED_ITEMS;\n\t\t\tsuggestedItems = filter(\n\t\t\t\titems,\n\t\t\t\t( item ) => item.utility > 0\n\t\t\t).slice( 0, maxSuggestedItems );\n\t\t}\n\n\t\tconst reusableItems = filter( filteredItems, { category: 'reusable' } );\n\n\t\tconst getCategoryIndex = ( item ) => {\n\t\t\treturn findIndex(\n\t\t\t\tcategories,\n\t\t\t\t( category ) => category.slug === item.category\n\t\t\t);\n\t\t};\n\t\tconst itemsPerCategory = flow(\n\t\t\t( itemList ) =>\n\t\t\t\tfilter( itemList, ( item ) => item.category !== 'reusable' ),\n\t\t\t( itemList ) => sortBy( itemList, getCategoryIndex ),\n\t\t\t( itemList ) => groupBy( itemList, 'category' )\n\t\t)( filteredItems );\n\n\t\t// Create a new Object to avoid mutating this.props.collection\n\t\tconst itemsPerCollection = { ...collections };\n\t\tObject.keys( collections ).forEach( ( namespace ) => {\n\t\t\titemsPerCollection[ namespace ] = filteredItems.filter(\n\t\t\t\t( item ) => getBlockNamespace( item ) === namespace\n\t\t\t);\n\t\t\tif ( itemsPerCollection[ namespace ].length === 0 ) {\n\t\t\t\tdelete itemsPerCollection[ namespace ];\n\t\t\t}\n\t\t} );\n\n\t\tthis.setState( {\n\t\t\thoveredItem: null,\n\t\t\tchildItems,\n\t\t\tfilterValue,\n\t\t\tsuggestedItems,\n\t\t\treusableItems,\n\t\t\titemsPerCategory,\n\t\t\titemsPerCollection,\n\t\t\topenPanels: this.filterOpenPanels(\n\t\t\t\tfilterValue,\n\t\t\t\titemsPerCategory,\n\t\t\t\titemsPerCollection,\n\t\t\t\tfilteredItems,\n\t\t\t\treusableItems\n\t\t\t),\n\t\t} );\n\n\t\tconst resultCount = Object.keys( itemsPerCategory ).reduce(\n\t\t\t( accumulator, currentCategorySlug ) => {\n\t\t\t\treturn (\n\t\t\t\t\taccumulator + itemsPerCategory[ currentCategorySlug ].length\n\t\t\t\t);\n\t\t\t},\n\t\t\t0\n\t\t);\n\n\t\tconst resultsFoundMessage = sprintf(\n\t\t\t_n( '%d result found.', '%d results found.', resultCount ),\n\t\t\tresultCount\n\t\t);\n\t\tdebouncedSpeak( resultsFoundMessage );\n\t}\n\n\tonKeyDown( event ) {\n\t\tif (\n\t\t\tincludes(\n\t\t\t\t[ LEFT, DOWN, RIGHT, UP, BACKSPACE, ENTER ],\n\t\t\t\tevent.keyCode\n\t\t\t)\n\t\t) {\n\t\t\t// Stop the key event from propagating up to ObserveTyping.startTypingInTextField.\n\t\t\tevent.stopPropagation();\n\t\t}\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tcategories,\n\t\t\tcollections,\n\t\t\tinstanceId,\n\t\t\tonSelect,\n\t\t\trootClientId,\n\t\t\tshowInserterHelpPanel,\n\t\t} = this.props;\n\t\tconst {\n\t\t\tchildItems,\n\t\t\thoveredItem,\n\t\t\titemsPerCategory,\n\t\t\titemsPerCollection,\n\t\t\topenPanels,\n\t\t\treusableItems,\n\t\t\tsuggestedItems,\n\t\t\tfilterValue,\n\t\t} = this.state;\n\t\tconst isPanelOpen = ( panel ) => openPanels.indexOf( panel ) !== -1;\n\t\tconst hasItems =\n\t\t\t! isEmpty( suggestedItems ) ||\n\t\t\t! isEmpty( reusableItems ) ||\n\t\t\t! isEmpty( itemsPerCategory ) ||\n\t\t\t! isEmpty( itemsPerCollection );\n\t\tconst hoveredItemBlockType = hoveredItem\n\t\t\t? getBlockType( hoveredItem.name )\n\t\t\t: null;\n\t\tconst hasHelpPanel = hasItems && showInserterHelpPanel;\n\n\t\t// Disable reason (no-autofocus): The inserter menu is a modal display, not one which\n\t\t// is always visible, and one which already incurs this behavior of autoFocus via\n\t\t// Popover's focusOnMount.\n\t\t// Disable reason (no-static-element-interactions): Navigational key-presses within\n\t\t// the menu are prevented from triggering WritingFlow and ObserveTyping interactions.\n\t\t/* eslint-disable jsx-a11y/no-autofocus, jsx-a11y/no-static-element-interactions */\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={ classnames( 'block-editor-inserter__menu', {\n\t\t\t\t\t'has-help-panel': hasHelpPanel,\n\t\t\t\t} ) }\n\t\t\t\tonKeyPress={ stopKeyPropagation }\n\t\t\t\tonKeyDown={ this.onKeyDown }\n\t\t\t>\n\t\t\t\t<div className=\"block-editor-inserter__main-area\">\n\t\t\t\t\t<label\n\t\t\t\t\t\thtmlFor={ `block-editor-inserter__search-${ instanceId }` }\n\t\t\t\t\t\tclassName=\"screen-reader-text\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Search for a block' ) }\n\t\t\t\t\t</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\tid={ `block-editor-inserter__search-${ instanceId }` }\n\t\t\t\t\t\ttype=\"search\"\n\t\t\t\t\t\tplaceholder={ __( 'Search for a block' ) }\n\t\t\t\t\t\tclassName=\"block-editor-inserter__search\"\n\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\tonChange={ this.onChangeSearchInput }\n\t\t\t\t\t/>\n\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"block-editor-inserter__results\"\n\t\t\t\t\t\tref={ this.inserterResults }\n\t\t\t\t\t\ttabIndex=\"0\"\n\t\t\t\t\t\trole=\"region\"\n\t\t\t\t\t\taria-label={ __( 'Available block types' ) }\n\t\t\t\t\t>\n\t\t\t\t\t\t<ChildBlocks\n\t\t\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\t\t\titems={ childItems }\n\t\t\t\t\t\t\tonSelect={ onSelect }\n\t\t\t\t\t\t\tonHover={ this.onHover }\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t{ !! suggestedItems.length && (\n\t\t\t\t\t\t\t<PanelBody\n\t\t\t\t\t\t\t\ttitle={ _x( 'Most used', 'blocks' ) }\n\t\t\t\t\t\t\t\topened={ isPanelOpen( 'suggested' ) }\n\t\t\t\t\t\t\t\tonToggle={ this.onTogglePanel( 'suggested' ) }\n\t\t\t\t\t\t\t\tref={ this.bindPanel( 'suggested' ) }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<BlockTypesList\n\t\t\t\t\t\t\t\t\titems={ suggestedItems }\n\t\t\t\t\t\t\t\t\tonSelect={ onSelect }\n\t\t\t\t\t\t\t\t\tonHover={ this.onHover }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</PanelBody>\n\t\t\t\t\t\t) }\n\n\t\t\t\t\t\t{ map( categories, ( category ) => {\n\t\t\t\t\t\t\tconst categoryItems =\n\t\t\t\t\t\t\t\titemsPerCategory[ category.slug ];\n\t\t\t\t\t\t\tif ( ! categoryItems || ! categoryItems.length ) {\n\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<PanelBody\n\t\t\t\t\t\t\t\t\tkey={ category.slug }\n\t\t\t\t\t\t\t\t\ttitle={ category.title }\n\t\t\t\t\t\t\t\t\ticon={ category.icon }\n\t\t\t\t\t\t\t\t\topened={ isPanelOpen( category.slug ) }\n\t\t\t\t\t\t\t\t\tonToggle={ this.onTogglePanel(\n\t\t\t\t\t\t\t\t\t\tcategory.slug\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\tref={ this.bindPanel( category.slug ) }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<BlockTypesList\n\t\t\t\t\t\t\t\t\t\titems={ categoryItems }\n\t\t\t\t\t\t\t\t\t\tonSelect={ onSelect }\n\t\t\t\t\t\t\t\t\t\tonHover={ this.onHover }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</PanelBody>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} ) }\n\n\t\t\t\t\t\t{ map( collections, ( collection, namespace ) => {\n\t\t\t\t\t\t\tconst collectionItems =\n\t\t\t\t\t\t\t\titemsPerCollection[ namespace ];\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t! collectionItems ||\n\t\t\t\t\t\t\t\t! collectionItems.length\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<PanelBody\n\t\t\t\t\t\t\t\t\tkey={ namespace }\n\t\t\t\t\t\t\t\t\ttitle={ collection.title }\n\t\t\t\t\t\t\t\t\ticon={ collection.icon }\n\t\t\t\t\t\t\t\t\topened={ isPanelOpen( namespace ) }\n\t\t\t\t\t\t\t\t\tonToggle={ this.onTogglePanel( namespace ) }\n\t\t\t\t\t\t\t\t\tref={ this.bindPanel( namespace ) }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<BlockTypesList\n\t\t\t\t\t\t\t\t\t\titems={ collectionItems }\n\t\t\t\t\t\t\t\t\t\tonSelect={ onSelect }\n\t\t\t\t\t\t\t\t\t\tonHover={ this.onHover }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</PanelBody>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} ) }\n\n\t\t\t\t\t\t{ !! reusableItems.length && (\n\t\t\t\t\t\t\t<PanelBody\n\t\t\t\t\t\t\t\tclassName=\"block-editor-inserter__reusable-blocks-panel\"\n\t\t\t\t\t\t\t\ttitle={ __( 'Reusable' ) }\n\t\t\t\t\t\t\t\topened={ isPanelOpen( 'reusable' ) }\n\t\t\t\t\t\t\t\tonToggle={ this.onTogglePanel( 'reusable' ) }\n\t\t\t\t\t\t\t\ticon=\"controls-repeat\"\n\t\t\t\t\t\t\t\tref={ this.bindPanel( 'reusable' ) }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<BlockTypesList\n\t\t\t\t\t\t\t\t\titems={ reusableItems }\n\t\t\t\t\t\t\t\t\tonSelect={ onSelect }\n\t\t\t\t\t\t\t\t\tonHover={ this.onHover }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\tclassName=\"block-editor-inserter__manage-reusable-blocks\"\n\t\t\t\t\t\t\t\t\thref={ addQueryArgs( 'edit.php', {\n\t\t\t\t\t\t\t\t\t\tpost_type: 'wp_block',\n\t\t\t\t\t\t\t\t\t} ) }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{ __( 'Manage all reusable blocks' ) }\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</PanelBody>\n\t\t\t\t\t\t) }\n\n\t\t\t\t\t\t<__experimentalInserterMenuExtension.Slot\n\t\t\t\t\t\t\tfillProps={ {\n\t\t\t\t\t\t\t\tonSelect,\n\t\t\t\t\t\t\t\tonHover: this.onHover,\n\t\t\t\t\t\t\t\tfilterValue,\n\t\t\t\t\t\t\t\thasItems,\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ ( fills ) => {\n\t\t\t\t\t\t\t\tif ( fills.length ) {\n\t\t\t\t\t\t\t\t\treturn fills;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ( ! hasItems ) {\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<p className=\"block-editor-inserter__no-results\">\n\t\t\t\t\t\t\t\t\t\t\t{ __( 'No blocks found.' ) }\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t</__experimentalInserterMenuExtension.Slot>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t{ hasHelpPanel && (\n\t\t\t\t\t<div className=\"block-editor-inserter__menu-help-panel\">\n\t\t\t\t\t\t{ hoveredItem && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{ ! isReusableBlock( hoveredItem ) && (\n\t\t\t\t\t\t\t\t\t<BlockCard blockType={ hoveredItem } />\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t<div className=\"block-editor-inserter__preview\">\n\t\t\t\t\t\t\t\t\t{ isReusableBlock( hoveredItem ) ||\n\t\t\t\t\t\t\t\t\thoveredItemBlockType.example ? (\n\t\t\t\t\t\t\t\t\t\t<div className=\"block-editor-inserter__preview-content\">\n\t\t\t\t\t\t\t\t\t\t\t<BlockPreview\n\t\t\t\t\t\t\t\t\t\t\t\tpadding={ 10 }\n\t\t\t\t\t\t\t\t\t\t\t\tviewportWidth={ 500 }\n\t\t\t\t\t\t\t\t\t\t\t\tblocks={\n\t\t\t\t\t\t\t\t\t\t\t\t\thoveredItemBlockType.example\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? getBlockFromExample(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thoveredItem.name,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattributes: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...hoveredItemBlockType\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.example\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attributes,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...hoveredItem.initialAttributes,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tinnerBlocks:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thoveredItemBlockType\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.example\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.innerBlocks,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: createBlock(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thoveredItem.name,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thoveredItem.initialAttributes\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<div className=\"block-editor-inserter__preview-content-missing\">\n\t\t\t\t\t\t\t\t\t\t\t{ __( 'No Preview Available.' ) }\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t{ ! hoveredItem && (\n\t\t\t\t\t\t\t<div className=\"block-editor-inserter__menu-help-panel-no-block\">\n\t\t\t\t\t\t\t\t<div className=\"block-editor-inserter__menu-help-panel-no-block-text\">\n\t\t\t\t\t\t\t\t\t<div className=\"block-editor-inserter__menu-help-panel-title\">\n\t\t\t\t\t\t\t\t\t\t{ __( 'Content blocks' ) }\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t\t\t\t'Welcome to the wonderful world of blocks! Blocks are the basis of all content within the editor.'\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t\t\t\t'There are blocks available for all kinds of content: insert text, headings, images, lists, videos, tables, and lots more.'\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t{ __(\n\t\t\t\t\t\t\t\t\t\t\t'Browse through the library to learn more about what each block does.'\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<Tip>\n\t\t\t\t\t\t\t\t\t{ __experimentalCreateInterpolateElement(\n\t\t\t\t\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t\t\t\t\t'While writing, you can press <kbd>/</kbd> to quickly insert new blocks.'\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t{ kbd: <kbd /> }\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t</Tip>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</div>\n\t\t\t\t) }\n\t\t\t</div>\n\t\t);\n\t\t/* eslint-enable jsx-a11y/no-autofocus, jsx-a11y/no-static-element-interactions */\n\t}\n}\n\nexport default compose(\n\twithSelect(\n\t\t(\n\t\t\tselect,\n\t\t\t{ clientId, isAppender, rootClientId, showInserterHelpPanel }\n\t\t) => {\n\t\t\tconst {\n\t\t\t\tgetInserterItems,\n\t\t\t\tgetBlockName,\n\t\t\t\tgetBlockRootClientId,\n\t\t\t\tgetBlockSelectionEnd,\n\t\t\t\tgetSettings,\n\t\t\t} = select( 'core/block-editor' );\n\t\t\tconst {\n\t\t\t\tgetCategories,\n\t\t\t\tgetCollections,\n\t\t\t\tgetChildBlockNames,\n\t\t\t} = select( 'core/blocks' );\n\n\t\t\tlet destinationRootClientId = rootClientId;\n\t\t\tif ( ! destinationRootClientId && ! clientId && ! isAppender ) {\n\t\t\t\tconst end = getBlockSelectionEnd();\n\t\t\t\tif ( end ) {\n\t\t\t\t\tdestinationRootClientId =\n\t\t\t\t\t\tgetBlockRootClientId( end ) || undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst destinationRootBlockName = getBlockName(\n\t\t\t\tdestinationRootClientId\n\t\t\t);\n\n\t\t\tconst {\n\t\t\t\tshowInserterHelpPanel: showInserterHelpPanelSetting,\n\t\t\t\t__experimentalFetchReusableBlocks: fetchReusableBlocks,\n\t\t\t} = getSettings();\n\n\t\t\treturn {\n\t\t\t\tcategories: getCategories(),\n\t\t\t\tcollections: getCollections(),\n\t\t\t\trootChildBlocks: getChildBlockNames( destinationRootBlockName ),\n\t\t\t\titems: getInserterItems( destinationRootClientId ),\n\t\t\t\tshowInserterHelpPanel:\n\t\t\t\t\tshowInserterHelpPanel && showInserterHelpPanelSetting,\n\t\t\t\tdestinationRootClientId,\n\t\t\t\tfetchReusableBlocks,\n\t\t\t};\n\t\t}\n\t),\n\twithDispatch( ( dispatch, ownProps, { select } ) => {\n\t\tconst { showInsertionPoint, hideInsertionPoint } = dispatch(\n\t\t\t'core/block-editor'\n\t\t);\n\n\t\t// To avoid duplication, getInsertionIndex is extracted and used in two event handlers\n\t\t// This breaks the withDispatch not containing any logic rule.\n\t\t// Since it's a function only called when the event handlers are called,\n\t\t// it's fine to extract it.\n\t\t// eslint-disable-next-line no-restricted-syntax\n\t\tfunction getInsertionIndex() {\n\t\t\tconst {\n\t\t\t\tgetBlockIndex,\n\t\t\t\tgetBlockSelectionEnd,\n\t\t\t\tgetBlockOrder,\n\t\t\t} = select( 'core/block-editor' );\n\t\t\tconst { clientId, destinationRootClientId, isAppender } = ownProps;\n\n\t\t\t// If the clientId is defined, we insert at the position of the block.\n\t\t\tif ( clientId ) {\n\t\t\t\treturn getBlockIndex( clientId, destinationRootClientId );\n\t\t\t}\n\n\t\t\t// If there a selected block, we insert after the selected block.\n\t\t\tconst end = getBlockSelectionEnd();\n\t\t\tif ( ! isAppender && end ) {\n\t\t\t\treturn getBlockIndex( end, destinationRootClientId ) + 1;\n\t\t\t}\n\n\t\t\t// Otherwise, we insert at the end of the current rootClientId\n\t\t\treturn getBlockOrder( destinationRootClientId ).length;\n\t\t}\n\n\t\treturn {\n\t\t\tshowInsertionPoint() {\n\t\t\t\tconst index = getInsertionIndex();\n\t\t\t\tshowInsertionPoint( ownProps.destinationRootClientId, index );\n\t\t\t},\n\t\t\thideInsertionPoint,\n\t\t\tonSelect( item ) {\n\t\t\t\tconst { replaceBlocks, insertBlock } = dispatch(\n\t\t\t\t\t'core/block-editor'\n\t\t\t\t);\n\t\t\t\tconst { getSelectedBlock } = select( 'core/block-editor' );\n\t\t\t\tconst {\n\t\t\t\t\tisAppender,\n\t\t\t\t\tonSelect,\n\t\t\t\t\t__experimentalSelectBlockOnInsert: selectBlockOnInsert,\n\t\t\t\t} = ownProps;\n\t\t\t\tconst { name, title, initialAttributes, innerBlocks } = item;\n\t\t\t\tconst selectedBlock = getSelectedBlock();\n\t\t\t\tconst insertedBlock = createBlock(\n\t\t\t\t\tname,\n\t\t\t\t\tinitialAttributes,\n\t\t\t\t\tcreateBlocksFromInnerBlocksTemplate( innerBlocks )\n\t\t\t\t);\n\n\t\t\t\tif (\n\t\t\t\t\t! isAppender &&\n\t\t\t\t\tselectedBlock &&\n\t\t\t\t\tisUnmodifiedDefaultBlock( selectedBlock )\n\t\t\t\t) {\n\t\t\t\t\treplaceBlocks( selectedBlock.clientId, insertedBlock );\n\t\t\t\t} else {\n\t\t\t\t\tinsertBlock(\n\t\t\t\t\t\tinsertedBlock,\n\t\t\t\t\t\tgetInsertionIndex(),\n\t\t\t\t\t\townProps.destinationRootClientId,\n\t\t\t\t\t\tselectBlockOnInsert\n\t\t\t\t\t);\n\n\t\t\t\t\tif ( ! selectBlockOnInsert ) {\n\t\t\t\t\t\t// translators: %s: the name of the block that has been added\n\t\t\t\t\t\tconst message = sprintf(\n\t\t\t\t\t\t\t__( '%s block added' ),\n\t\t\t\t\t\t\ttitle\n\t\t\t\t\t\t);\n\t\t\t\t\t\tspeak( message );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tonSelect();\n\t\t\t\treturn insertedBlock;\n\t\t\t},\n\t\t};\n\t} ),\n\twithSpokenMessages,\n\twithInstanceId,\n\twithSafeTimeout\n)( InserterMenu );\n"]}