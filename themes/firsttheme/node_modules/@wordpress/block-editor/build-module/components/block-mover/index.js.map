{"version":3,"sources":["@wordpress/block-editor/src/components/block-mover/index.js"],"names":["first","last","partial","castArray","classnames","__","Button","ToolbarGroup","getBlockType","Component","withSelect","withDispatch","withInstanceId","compose","getBlockMoverDescription","leftArrow","rightArrow","dragHandle","chevronUp","chevronDown","BlockDraggable","BlockMover","arguments","state","isFocused","onFocus","bind","onBlur","setState","props","onMoveUp","onMoveDown","orientation","__experimentalOrientation","isRTL","isFirst","isLast","clientIds","blockType","firstIndex","isLocked","instanceId","isHidden","rootClientId","hideDragHandle","blocksCount","length","getArrowIcon","moveDirection","getMovementDirectionLabel","onDraggableStart","onDraggableEnd","title","select","getBlock","getBlockIndex","getTemplateLock","getBlockRootClientId","getBlockOrder","normalizedClientIds","firstClientId","block","blockOrder","lastIndex","getSettings","name","dispatch","moveBlocksDown","moveBlocksUp"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { first, last, partial, castArray } from 'lodash';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Button, ToolbarGroup } from '@wordpress/components';\nimport { getBlockType } from '@wordpress/blocks';\nimport { Component } from '@wordpress/element';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { withInstanceId, compose } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { getBlockMoverDescription } from './mover-description';\nimport { leftArrow, rightArrow, dragHandle } from './icons';\nimport { chevronUp, chevronDown } from '@wordpress/icons';\nimport BlockDraggable from '../block-draggable';\n\nexport class BlockMover extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.state = {\n\t\t\tisFocused: false,\n\t\t};\n\t\tthis.onFocus = this.onFocus.bind( this );\n\t\tthis.onBlur = this.onBlur.bind( this );\n\t}\n\n\tonFocus() {\n\t\tthis.setState( {\n\t\t\tisFocused: true,\n\t\t} );\n\t}\n\n\tonBlur() {\n\t\tthis.setState( {\n\t\t\tisFocused: false,\n\t\t} );\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\tonMoveUp,\n\t\t\tonMoveDown,\n\t\t\t__experimentalOrientation: orientation,\n\t\t\tisRTL,\n\t\t\tisFirst,\n\t\t\tisLast,\n\t\t\tclientIds,\n\t\t\tblockType,\n\t\t\tfirstIndex,\n\t\t\tisLocked,\n\t\t\tinstanceId,\n\t\t\tisHidden,\n\t\t\trootClientId,\n\t\t\thideDragHandle,\n\t\t} = this.props;\n\t\tconst { isFocused } = this.state;\n\t\tconst blocksCount = castArray( clientIds ).length;\n\t\tif ( isLocked || ( isFirst && isLast && ! rootClientId ) ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst getArrowIcon = ( moveDirection ) => {\n\t\t\tif ( moveDirection === 'up' ) {\n\t\t\t\tif ( orientation === 'horizontal' ) {\n\t\t\t\t\treturn isRTL ? rightArrow : leftArrow;\n\t\t\t\t}\n\t\t\t\treturn chevronUp;\n\t\t\t} else if ( moveDirection === 'down' ) {\n\t\t\t\tif ( orientation === 'horizontal' ) {\n\t\t\t\t\treturn isRTL ? leftArrow : rightArrow;\n\t\t\t\t}\n\t\t\t\treturn chevronDown;\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\n\t\tconst getMovementDirectionLabel = ( moveDirection ) => {\n\t\t\tif ( moveDirection === 'up' ) {\n\t\t\t\tif ( orientation === 'horizontal' ) {\n\t\t\t\t\treturn isRTL ? __( 'Move right' ) : __( 'Move left' );\n\t\t\t\t}\n\t\t\t\treturn __( 'Move up' );\n\t\t\t} else if ( moveDirection === 'down' ) {\n\t\t\t\tif ( orientation === 'horizontal' ) {\n\t\t\t\t\treturn isRTL ? __( 'Move left' ) : __( 'Move right' );\n\t\t\t\t}\n\t\t\t\treturn __( 'Move down' );\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\n\t\t// We emulate a disabled state because forcefully applying the `disabled`\n\t\t// attribute on the button while it has focus causes the screen to change\n\t\t// to an unfocused state (body as active element) without firing blur on,\n\t\t// the rendering parent, leaving it unable to react to focus out.\n\t\treturn (\n\t\t\t<ToolbarGroup\n\t\t\t\tclassName={ classnames( 'block-editor-block-mover', {\n\t\t\t\t\t'is-visible': isFocused || ! isHidden,\n\t\t\t\t\t'is-horizontal': orientation === 'horizontal',\n\t\t\t\t} ) }\n\t\t\t>\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"block-editor-block-mover__control\"\n\t\t\t\t\tonClick={ isFirst ? null : onMoveUp }\n\t\t\t\t\ticon={ getArrowIcon( 'up' ) }\n\t\t\t\t\tlabel={ getMovementDirectionLabel( 'up' ) }\n\t\t\t\t\taria-describedby={ `block-editor-block-mover__up-description-${ instanceId }` }\n\t\t\t\t\taria-disabled={ isFirst }\n\t\t\t\t\tonFocus={ this.onFocus }\n\t\t\t\t\tonBlur={ this.onBlur }\n\t\t\t\t/>\n\n\t\t\t\t{ ! hideDragHandle && (\n\t\t\t\t\t<BlockDraggable clientIds={ clientIds }>\n\t\t\t\t\t\t{ ( { onDraggableStart, onDraggableEnd } ) => (\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\ticon={ dragHandle }\n\t\t\t\t\t\t\t\tclassName=\"block-editor-block-mover__control-drag-handle block-editor-block-mover__control\"\n\t\t\t\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\t\t\t\t// Should not be able to tab to drag handle as this\n\t\t\t\t\t\t\t\t// button can only be used with a pointer device.\n\t\t\t\t\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t\t\t\t\tonDragStart={ onDraggableStart }\n\t\t\t\t\t\t\t\tonDragEnd={ onDraggableEnd }\n\t\t\t\t\t\t\t\tdraggable\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</BlockDraggable>\n\t\t\t\t) }\n\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"block-editor-block-mover__control\"\n\t\t\t\t\tonClick={ isLast ? null : onMoveDown }\n\t\t\t\t\ticon={ getArrowIcon( 'down' ) }\n\t\t\t\t\tlabel={ getMovementDirectionLabel( 'down' ) }\n\t\t\t\t\taria-describedby={ `block-editor-block-mover__down-description-${ instanceId }` }\n\t\t\t\t\taria-disabled={ isLast }\n\t\t\t\t\tonFocus={ this.onFocus }\n\t\t\t\t\tonBlur={ this.onBlur }\n\t\t\t\t/>\n\t\t\t\t<span\n\t\t\t\t\tid={ `block-editor-block-mover__up-description-${ instanceId }` }\n\t\t\t\t\tclassName=\"block-editor-block-mover__description\"\n\t\t\t\t>\n\t\t\t\t\t{ getBlockMoverDescription(\n\t\t\t\t\t\tblocksCount,\n\t\t\t\t\t\tblockType && blockType.title,\n\t\t\t\t\t\tfirstIndex,\n\t\t\t\t\t\tisFirst,\n\t\t\t\t\t\tisLast,\n\t\t\t\t\t\t-1,\n\t\t\t\t\t\torientation,\n\t\t\t\t\t\tisRTL\n\t\t\t\t\t) }\n\t\t\t\t</span>\n\t\t\t\t<span\n\t\t\t\t\tid={ `block-editor-block-mover__down-description-${ instanceId }` }\n\t\t\t\t\tclassName=\"block-editor-block-mover__description\"\n\t\t\t\t>\n\t\t\t\t\t{ getBlockMoverDescription(\n\t\t\t\t\t\tblocksCount,\n\t\t\t\t\t\tblockType && blockType.title,\n\t\t\t\t\t\tfirstIndex,\n\t\t\t\t\t\tisFirst,\n\t\t\t\t\t\tisLast,\n\t\t\t\t\t\t1,\n\t\t\t\t\t\torientation,\n\t\t\t\t\t\tisRTL\n\t\t\t\t\t) }\n\t\t\t\t</span>\n\t\t\t</ToolbarGroup>\n\t\t);\n\t}\n}\n\nexport default compose(\n\twithSelect( ( select, { clientIds } ) => {\n\t\tconst {\n\t\t\tgetBlock,\n\t\t\tgetBlockIndex,\n\t\t\tgetTemplateLock,\n\t\t\tgetBlockRootClientId,\n\t\t\tgetBlockOrder,\n\t\t} = select( 'core/block-editor' );\n\t\tconst normalizedClientIds = castArray( clientIds );\n\t\tconst firstClientId = first( normalizedClientIds );\n\t\tconst block = getBlock( firstClientId );\n\t\tconst rootClientId = getBlockRootClientId(\n\t\t\tfirst( normalizedClientIds )\n\t\t);\n\t\tconst blockOrder = getBlockOrder( rootClientId );\n\t\tconst firstIndex = getBlockIndex( firstClientId, rootClientId );\n\t\tconst lastIndex = getBlockIndex(\n\t\t\tlast( normalizedClientIds ),\n\t\t\trootClientId\n\t\t);\n\t\tconst { getSettings } = select( 'core/block-editor' );\n\t\tconst { isRTL } = getSettings();\n\n\t\treturn {\n\t\t\tblockType: block ? getBlockType( block.name ) : null,\n\t\t\tisLocked: getTemplateLock( rootClientId ) === 'all',\n\t\t\trootClientId,\n\t\t\tfirstIndex,\n\t\t\tisRTL,\n\t\t\tisFirst: firstIndex === 0,\n\t\t\tisLast: lastIndex === blockOrder.length - 1,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { clientIds, rootClientId } ) => {\n\t\tconst { moveBlocksDown, moveBlocksUp } = dispatch(\n\t\t\t'core/block-editor'\n\t\t);\n\t\treturn {\n\t\t\tonMoveDown: partial( moveBlocksDown, clientIds, rootClientId ),\n\t\t\tonMoveUp: partial( moveBlocksUp, clientIds, rootClientId ),\n\t\t};\n\t} ),\n\twithInstanceId\n)( BlockMover );\n"]}