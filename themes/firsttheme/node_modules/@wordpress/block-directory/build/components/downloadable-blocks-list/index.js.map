{"version":3,"sources":["@wordpress/block-directory/src/components/downloadable-blocks-list/index.js"],"names":["DOWNLOAD_ERROR_NOTICE_ID","INSTALL_ERROR_NOTICE_ID","DownloadableBlocksList","items","onHover","noop","children","downloadAndInstallBlock","map","item","id","icons","dispatch","props","installBlock","downloadBlock","createErrorNotice","removeNotice","removeBlocks","onSelect","onDownloadError","actions","label","onClick","onSuccess","createdBlock","onInstallBlockError","clientId","name"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { noop } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport {\n\tgetBlockMenuDefaultClassName,\n\tunregisterBlockType,\n} from '@wordpress/blocks';\nimport { withDispatch } from '@wordpress/data';\nimport { compose } from '@wordpress/compose';\nimport { __ } from '@wordpress/i18n';\n\n/**\n * Internal dependencies\n */\nimport DownloadableBlockListItem from '../downloadable-block-list-item';\n\nconst DOWNLOAD_ERROR_NOTICE_ID = 'block-download-error';\nconst INSTALL_ERROR_NOTICE_ID = 'block-install-error';\n\nfunction DownloadableBlocksList( {\n\titems,\n\tonHover = noop,\n\tchildren,\n\tdownloadAndInstallBlock,\n} ) {\n\treturn (\n\t\t/*\n\t\t * Disable reason: The `list` ARIA role is redundant but\n\t\t * Safari+VoiceOver won't announce the list otherwise.\n\t\t */\n\t\t/* eslint-disable jsx-a11y/no-redundant-roles */\n\t\t<ul role=\"list\" className=\"block-directory-downloadable-blocks-list\">\n\t\t\t{ items &&\n\t\t\t\titems.map( ( item ) => (\n\t\t\t\t\t<DownloadableBlockListItem\n\t\t\t\t\t\tkey={ item.id }\n\t\t\t\t\t\tclassName={ getBlockMenuDefaultClassName( item.id ) }\n\t\t\t\t\t\ticons={ item.icons }\n\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\tdownloadAndInstallBlock( item );\n\t\t\t\t\t\t\tonHover( null );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonFocus={ () => onHover( item ) }\n\t\t\t\t\t\tonMouseEnter={ () => onHover( item ) }\n\t\t\t\t\t\tonMouseLeave={ () => onHover( null ) }\n\t\t\t\t\t\tonBlur={ () => onHover( null ) }\n\t\t\t\t\t\titem={ item }\n\t\t\t\t\t/>\n\t\t\t\t) ) }\n\t\t\t{ children }\n\t\t</ul>\n\t\t/* eslint-enable jsx-a11y/no-redundant-roles */\n\t);\n}\n\nexport default compose(\n\twithDispatch( ( dispatch, props ) => {\n\t\tconst { installBlock, downloadBlock } = dispatch(\n\t\t\t'core/block-directory'\n\t\t);\n\t\tconst { createErrorNotice, removeNotice } = dispatch( 'core/notices' );\n\t\tconst { removeBlocks } = dispatch( 'core/block-editor' );\n\t\tconst { onSelect } = props;\n\n\t\treturn {\n\t\t\tdownloadAndInstallBlock: ( item ) => {\n\t\t\t\tconst onDownloadError = () => {\n\t\t\t\t\tcreateErrorNotice( __( 'Block previews canâ€™t load.' ), {\n\t\t\t\t\t\tid: DOWNLOAD_ERROR_NOTICE_ID,\n\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: __( 'Retry' ),\n\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\tremoveNotice( DOWNLOAD_ERROR_NOTICE_ID );\n\t\t\t\t\t\t\t\t\tdownloadBlock(\n\t\t\t\t\t\t\t\t\t\titem,\n\t\t\t\t\t\t\t\t\t\tonSuccess,\n\t\t\t\t\t\t\t\t\t\tonDownloadError\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t} );\n\t\t\t\t};\n\n\t\t\t\tconst onSuccess = () => {\n\t\t\t\t\tconst createdBlock = onSelect( item );\n\n\t\t\t\t\tconst onInstallBlockError = () => {\n\t\t\t\t\t\tcreateErrorNotice(\n\t\t\t\t\t\t\t__( \"Block previews can't install.\" ),\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: INSTALL_ERROR_NOTICE_ID,\n\t\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel: __( 'Retry' ),\n\t\t\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\t\t\tremoveNotice(\n\t\t\t\t\t\t\t\t\t\t\t\tINSTALL_ERROR_NOTICE_ID\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\tinstallBlock(\n\t\t\t\t\t\t\t\t\t\t\t\titem,\n\t\t\t\t\t\t\t\t\t\t\t\tnoop,\n\t\t\t\t\t\t\t\t\t\t\t\tonInstallBlockError\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tlabel: __( 'Remove' ),\n\t\t\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\t\t\tremoveNotice(\n\t\t\t\t\t\t\t\t\t\t\t\tINSTALL_ERROR_NOTICE_ID\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\tremoveBlocks(\n\t\t\t\t\t\t\t\t\t\t\t\tcreatedBlock.clientId\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\tunregisterBlockType( item.name );\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t};\n\n\t\t\t\t\tinstallBlock( item, noop, onInstallBlockError );\n\t\t\t\t};\n\n\t\t\t\tdownloadBlock( item, onSuccess, onDownloadError );\n\t\t\t},\n\t\t};\n\t} )\n)( DownloadableBlocksList );\n"]}