{"version":3,"sources":["@wordpress/editor/src/components/post-title/index.js"],"names":["REGEXP_NEWLINES","PostTitle","arguments","onChange","bind","onSelect","onUnselect","onKeyDown","state","isSelected","setState","props","clearSelectedBlock","event","newTitle","target","value","replace","onUpdate","keyCode","ENTER","preventDefault","onEnterPress","hasFixedToolbar","isCleanNewPost","isFocusMode","isPostTypeViewable","instanceId","placeholder","title","className","decodedPlaceholder","document","body","activeElement","Component","applyWithSelect","select","getEditedPostAttribute","getSettings","getPostType","postType","titlePlaceholder","focusMode","applyWithDispatch","dispatch","insertDefaultBlock","editPost","undefined","withInstanceId","withFocusOutside"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport Textarea from 'react-autosize-textarea';\nimport classnames from 'classnames';\nimport { get } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Component } from '@wordpress/element';\nimport { decodeEntities } from '@wordpress/html-entities';\nimport { ENTER } from '@wordpress/keycodes';\nimport { withSelect, withDispatch } from '@wordpress/data';\nimport { withFocusOutside } from '@wordpress/components';\nimport { withInstanceId, compose } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport PostPermalink from '../post-permalink';\nimport PostTypeSupportCheck from '../post-type-support-check';\n\n/**\n * Constants\n */\nconst REGEXP_NEWLINES = /[\\r\\n]+/g;\n\nclass PostTitle extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.onChange = this.onChange.bind( this );\n\t\tthis.onSelect = this.onSelect.bind( this );\n\t\tthis.onUnselect = this.onUnselect.bind( this );\n\t\tthis.onKeyDown = this.onKeyDown.bind( this );\n\n\t\tthis.state = {\n\t\t\tisSelected: false,\n\t\t};\n\t}\n\n\thandleFocusOutside() {\n\t\tthis.onUnselect();\n\t}\n\n\tonSelect() {\n\t\tthis.setState( { isSelected: true } );\n\t\tthis.props.clearSelectedBlock();\n\t}\n\n\tonUnselect() {\n\t\tthis.setState( { isSelected: false } );\n\t}\n\n\tonChange( event ) {\n\t\tconst newTitle = event.target.value.replace( REGEXP_NEWLINES, ' ' );\n\t\tthis.props.onUpdate( newTitle );\n\t}\n\n\tonKeyDown( event ) {\n\t\tif ( event.keyCode === ENTER ) {\n\t\t\tevent.preventDefault();\n\t\t\tthis.props.onEnterPress();\n\t\t}\n\t}\n\n\trender() {\n\t\tconst {\n\t\t\thasFixedToolbar,\n\t\t\tisCleanNewPost,\n\t\t\tisFocusMode,\n\t\t\tisPostTypeViewable,\n\t\t\tinstanceId,\n\t\t\tplaceholder,\n\t\t\ttitle,\n\t\t} = this.props;\n\t\tconst { isSelected } = this.state;\n\n\t\t// The wp-block className is important for editor styles.\n\t\tconst className = classnames( 'wp-block editor-post-title__block', {\n\t\t\t'is-selected': isSelected,\n\t\t\t'is-focus-mode': isFocusMode,\n\t\t\t'has-fixed-toolbar': hasFixedToolbar,\n\t\t} );\n\t\tconst decodedPlaceholder = decodeEntities( placeholder );\n\n\t\treturn (\n\t\t\t<PostTypeSupportCheck supportKeys=\"title\">\n\t\t\t\t<div className=\"editor-post-title\">\n\t\t\t\t\t<div className={ className }>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label\n\t\t\t\t\t\t\t\thtmlFor={ `post-title-${ instanceId }` }\n\t\t\t\t\t\t\t\tclassName=\"screen-reader-text\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ decodedPlaceholder || __( 'Add title' ) }\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<Textarea\n\t\t\t\t\t\t\t\tid={ `post-title-${ instanceId }` }\n\t\t\t\t\t\t\t\tclassName=\"editor-post-title__input\"\n\t\t\t\t\t\t\t\tvalue={ title }\n\t\t\t\t\t\t\t\tonChange={ this.onChange }\n\t\t\t\t\t\t\t\tplaceholder={\n\t\t\t\t\t\t\t\t\tdecodedPlaceholder || __( 'Add title' )\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tonFocus={ this.onSelect }\n\t\t\t\t\t\t\t\tonKeyDown={ this.onKeyDown }\n\t\t\t\t\t\t\t\tonKeyPress={ this.onUnselect }\n\t\t\t\t\t\t\t\t/*\n\t\t\t\t\t\t\t\t\tOnly autofocus the title when the post is entirely empty.\n\t\t\t\t\t\t\t\t\tThis should only happen for a new post, which means we\n\t\t\t\t\t\t\t\t\tfocus the title on new post so the author can start typing\n\t\t\t\t\t\t\t\t\tright away, without needing to click anything.\n\t\t\t\t\t\t\t\t*/\n\t\t\t\t\t\t\t\t/* eslint-disable jsx-a11y/no-autofocus */\n\t\t\t\t\t\t\t\tautoFocus={\n\t\t\t\t\t\t\t\t\tdocument.body === document.activeElement &&\n\t\t\t\t\t\t\t\t\tisCleanNewPost\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/* eslint-enable jsx-a11y/no-autofocus */\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{ isSelected && isPostTypeViewable && (\n\t\t\t\t\t\t\t<PostPermalink />\n\t\t\t\t\t\t) }\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</PostTypeSupportCheck>\n\t\t);\n\t}\n}\n\nconst applyWithSelect = withSelect( ( select ) => {\n\tconst { getEditedPostAttribute, isCleanNewPost } = select( 'core/editor' );\n\tconst { getSettings } = select( 'core/block-editor' );\n\tconst { getPostType } = select( 'core' );\n\tconst postType = getPostType( getEditedPostAttribute( 'type' ) );\n\tconst { titlePlaceholder, focusMode, hasFixedToolbar } = getSettings();\n\n\treturn {\n\t\tisCleanNewPost: isCleanNewPost(),\n\t\ttitle: getEditedPostAttribute( 'title' ),\n\t\tisPostTypeViewable: get( postType, [ 'viewable' ], false ),\n\t\tplaceholder: titlePlaceholder,\n\t\tisFocusMode: focusMode,\n\t\thasFixedToolbar,\n\t};\n} );\n\nconst applyWithDispatch = withDispatch( ( dispatch ) => {\n\tconst { insertDefaultBlock, clearSelectedBlock } = dispatch(\n\t\t'core/block-editor'\n\t);\n\tconst { editPost } = dispatch( 'core/editor' );\n\n\treturn {\n\t\tonEnterPress() {\n\t\t\tinsertDefaultBlock( undefined, undefined, 0 );\n\t\t},\n\t\tonUpdate( title ) {\n\t\t\teditPost( { title } );\n\t\t},\n\t\tclearSelectedBlock,\n\t};\n} );\n\nexport default compose(\n\tapplyWithSelect,\n\tapplyWithDispatch,\n\twithInstanceId,\n\twithFocusOutside\n)( PostTitle );\n"]}